<!DOCTYPE html><html lang="default" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>CEX永续合约交易规则详解 | Jiahao Luo</title><meta name="author" content="Michael(Jiahao) Luo"><meta name="copyright" content="Michael(Jiahao) Luo"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate"><meta http-equiv="Pragma" content="no-cache"><meta http-equiv="Expires" content="0"><meta name="description" content="本文系统梳理了CEX永续合约的完整规则体系，涵盖合约类型、订单簿机制、资金费率、杠杆与保证金、风险管理（强制平仓与自动减仓）、费用结构等核心内容，适合数字货币衍生品投资者和风险管理研究者参考。">
<meta property="og:type" content="article">
<meta property="og:title" content="CEX永续合约交易规则详解">
<meta property="og:url" content="https://www.blog-blockchain.xyz/finance/cex-perp/index.html">
<meta property="og:site_name" content="Jiahao Luo">
<meta property="og:description" content="本文系统梳理了CEX永续合约的完整规则体系，涵盖合约类型、订单簿机制、资金费率、杠杆与保证金、风险管理（强制平仓与自动减仓）、费用结构等核心内容，适合数字货币衍生品投资者和风险管理研究者参考。">
<meta property="og:locale">
<meta property="og:image" content="https://cdn.blog-blockchain.xyz/2025/07/74399f8c78200a815d4cd88c3e39c4a7.jpg">
<meta property="article:published_time" content="2025-07-15T13:26:20.000Z">
<meta property="article:modified_time" content="2025-07-15T18:07:58.837Z">
<meta property="article:author" content="Michael(Jiahao) Luo">
<meta property="article:tag" content="perpetual swap">
<meta property="article:tag" content="CEX">
<meta property="article:tag" content="OKX">
<meta property="article:tag" content="derivatives">
<meta property="article:tag" content="leverage">
<meta property="article:tag" content="risk management">
<meta property="article:tag" content="funding rate">
<meta property="article:tag" content="liquidation">
<meta property="article:tag" content="ADL">
<meta property="article:tag" content="margin">
<meta property="article:tag" content="cryptocurrency">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.blog-blockchain.xyz/2025/07/74399f8c78200a815d4cd88c3e39c4a7.jpg"><script type="application/ld+json">{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "CEX永续合约交易规则详解",
  "url": "https://www.blog-blockchain.xyz/finance/cex-perp/",
  "image": "https://cdn.blog-blockchain.xyz/2025/07/74399f8c78200a815d4cd88c3e39c4a7.jpg",
  "datePublished": "2025-07-15T13:26:20.000Z",
  "dateModified": "2025-07-15T18:07:58.837Z",
  "author": [
    {
      "@type": "Person",
      "name": "Michael(Jiahao) Luo",
      "url": "https://www.blog-blockchain.xyz/"
    }
  ]
}</script><link rel="shortcut icon" href="/images/favicon.png"><link rel="canonical" href="https://www.blog-blockchain.xyz/finance/cex-perp/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//www.google-analytics.com" crossorigin=""><link rel="preconnect" href="//hm.baidu.com"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="manifest" href="/pwa/manifest.json"><link rel="apple-touch-icon" sizes="180x180" href="/pwa/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/pwa/32.png"><link rel="icon" type="image/png" sizes="16x16" href="/pwa/16.png"><link rel="mask-icon" href="/pwa/safari-pinned-tab.svg" color="#5bbad5"><script>
    (() => {
      
    const saveToLocal = {
      set: (key, value, ttl) => {
        if (!ttl) return
        const expiry = Date.now() + ttl * 86400000
        localStorage.setItem(key, JSON.stringify({ value, expiry }))
      },
      get: key => {
        const itemStr = localStorage.getItem(key)
        if (!itemStr) return undefined
        const { value, expiry } = JSON.parse(itemStr)
        if (Date.now() > expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return value
      }
    }

    window.btf = {
      saveToLocal,
      getScript: (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        Object.entries(attr).forEach(([key, val]) => script.setAttribute(key, val))
        script.onload = script.onreadystatechange = () => {
          if (!script.readyState || /loaded|complete/.test(script.readyState)) resolve()
        }
        script.onerror = reject
        document.head.appendChild(script)
      }),
      getCSS: (url, id) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onload = link.onreadystatechange = () => {
          if (!link.readyState || /loaded|complete/.test(link.readyState)) resolve()
        }
        link.onerror = reject
        document.head.appendChild(link)
      }),
      addGlobalFn: (key, fn, name = false, parent = window) => {
        if (!false && key.startsWith('pjax')) return
        const globalFn = parent.globalFn || {}
        globalFn[key] = globalFn[key] || {}
        globalFn[key][name || Object.keys(globalFn[key]).length] = fn
        parent.globalFn = globalFn
      }
    }
  
      
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode

      const theme = saveToLocal.get('theme')
    
          theme === 'dark' ? activateDarkMode() : theme === 'light' ? activateLightMode() : null
        
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        document.documentElement.classList.toggle('hide-aside', asideStatus === 'hide')
      }
    
      
    const detectApple = () => {
      if (/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)) {
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
  
    })()
  </script><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?372b8854d18acf62880149b1e08e1901";
  var s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(hm, s);
})();
btf.addGlobalFn('pjaxComplete', () => {
  _hmt.push(['_trackPageview',window.location.pathname])
}, 'baidu_analytics')
</script><script async="async" src="https://www.googletagmanager.com/gtag/js?id=QXcJQjXxTMeUwnWykFW2xw"></script><script>window.dataLayer = window.dataLayer || []
function gtag(){dataLayer.push(arguments)}
gtag('js', new Date())
gtag('config', 'QXcJQjXxTMeUwnWykFW2xw')
btf.addGlobalFn('pjaxComplete', () => {
  gtag('config', 'QXcJQjXxTMeUwnWykFW2xw', {'page_path': window.location.pathname})
}, 'google_analytics')
</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":true,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"No results found for: ${query}","hits_stats":"${hits} articles found"}},
  translate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":500,"highlightFullpage":false,"highlightMacStyle":true},
  copy: {
    success: 'Copy Successful',
    error: 'Copy Failed',
    noSupport: 'Browser Not Supported'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  dateSuffix: {
    just: 'Just now',
    min: 'minutes ago',
    hour: 'hours ago',
    day: 'days ago',
    month: 'months ago'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.12.0/dist/infinitegrid.min.js',
    buttonText: 'Load More'
  },
  isPhotoFigcaption: false,
  islazyloadPlugin: false,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'CEX永续合约交易规则详解',
  isHighlightShrink: false,
  isToc: true,
  pageType: 'post'
}</script><meta name="generator" content="Hexo 7.3.0"><link rel="alternate" href="/atom.xml" title="Jiahao Luo" type="application/atom+xml">
<script>function loadCss(l){var d=document,h=d.head,s=d.createElement('link');s.rel='stylesheet';s.href=l;!function e(f){if (d.body)return f();setTimeout(function(){e(f)})}(function(){h.appendChild(s);});}loadCss('/style.css');loadCss('https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css');loadCss('https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.min.css');loadCss('https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.min.css');loadCss('https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css');</script><noscript><link rel="stylesheet" href="/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.7.2/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/themes/blue/pace-theme-minimal.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/css/share.min.css"></noscript></head><body><script>window.paceOptions = {
  restartOnPushState: false
}

btf.addGlobalFn('pjaxSend', () => {
  Pace.restart()
}, 'pace_restart')

</script><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img text-center"><img src="/images/site-avator.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="site-data text-center"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">98</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">63</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">30</div></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archive</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="not-top-img" id="page-header"><nav id="nav"><span id="blog-info"><a class="nav-site-title" href="/"><span class="site-name">Jiahao Luo</span></a><a class="nav-page-title" href="/"><span class="site-name">CEX永续合约交易规则详解</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> Search</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archive</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav></header><main class="layout" id="content-inner"><div id="post"><div id="post-info"><h1 class="post-title">CEX永续合约交易规则详解</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">Created</span><time class="post-meta-date-created" datetime="2025-07-15T13:26:20.000Z" title="Created 2025-07-15 21:26:20">2025-07-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">Updated</span><time class="post-meta-date-updated" datetime="2025-07-15T18:07:58.837Z" title="Updated 2025-07-16 02:07:58">2025-07-16</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/finance/">finance</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/finance/economics/">economics</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">Word Count:</span><span class="word-count">17.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">Reading Time:</span><span>58mins</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title=""><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">Post Views:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div><article class="container post-content" id="article-container"><h2 id="概述">概述</h2>
<p>永续合约是数字货币交易所（CEX）提供的主流衍生品工具，无到期日限制，通过资金费率机制使合约价格与现货价格保持一致。本文以OKX为主要示例，详细介绍CEX永续合约的完整规则体系，包括合约规格、保证金制度、风险管理机制等关键内容。</p>
<p><strong>重要声明</strong>：本文内容基于公开资料整理，以OKX平台规则为主要参考，仅供学习和研究使用。不同交易所的具体规则可能存在差异，实际交易时请以各平台官方文档和最新规则为准。投资有风险，请谨慎决策。</p>
<h3 id="核心术语定义">核心术语定义</h3>
<p>为确保本文表达的一致性和准确性，以下对主要术语进行统一定义：</p>
<ul>
<li><strong>永续合约（Perpetual Swap）</strong>：无到期日的衍生品合约，通过资金费率机制实现价格发现</li>
<li><strong>标记价格（Mark Price）</strong>：用于计算未实现盈亏和强制平仓的基准价格</li>
<li><strong>现货指数价格（Index Price）</strong>：基于多个现货交易所价格的加权平均值</li>
<li><strong>维持保证金（Maintenance Margin）</strong>：维持仓位不被强制平仓的最低保证金要求</li>
<li><strong>初始保证金（Initial Margin）</strong>：开仓时需要投入的保证金，也称开仓保证金</li>
<li><strong>强制平仓（Forced Liquidation）</strong>：当维持保证金率低于100%时系统自动平仓</li>
<li><strong>自动减仓（ADL）</strong>：风险准备金不足时强制平仓盈利仓位的机制</li>
<li><strong>资金费率（Funding Rate）</strong>：定期支付的费用，用于维持合约价格与现货价格的一致性</li>
<li><strong>杠杆倍数（Leverage）</strong>：放大投资效果的倍数，表示实际仓位价值与保证金的比例</li>
<li><strong>仓位（Position）</strong>：用户持有的合约数量，分为多仓（看涨）和空仓（看跌）</li>
</ul>
<h2 id="1-永续合约基础架构">1. 永续合约基础架构</h2>
<p>本章节将从合约类型、订单簿机制等基础要素出发，建立对CEX永续合约系统的整体认知。通过对比分析USDT本位与币本位合约的特点，以及深入解析订单簿的构成原理，为后续章节的交易机制和风险管理奠定理论基础。以OKX平台规则为主要参考示例。</p>
<h3 id="1-1-永续合约类型与规格">1.1 永续合约类型与规格</h3>
<h4 id="1-1-1-合约类型分类">1.1.1 合约类型分类</h4>
<p><strong>图1 永续合约类型分类对比</strong></p>
<pre class="mermaid">graph TD
    A["永续合约类型"] --&gt; B["USDT本位合约<br>（主流）"]
    A --&gt; C["币本位合约<br>（较少使用）"]

    B --&gt; D["结算货币: USDT<br>合约面值: 固定数量标的资产<br>杠杆: 0.01-100倍<br>优势: 收益计算直观"]

    C --&gt; E["结算货币: 标的加密货币<br>合约面值: 100美元等值<br>杠杆: 0.01-100倍<br>适用: 套期保值需求"]

    style B fill:#e1f5fe
    style C fill:#fff3e0
    style A fill:#f3e5f5</pre>
<p>如图1所示，永续合约主要分为USDT本位合约和币本位合约两大类型。其中USDT本位合约因其收益计算直观、以USDT计价便于理解盈亏等优势，成为市场主流选择。</p>
<h5 id="1-1-1-1-USDT本位永续合约（主流）">1.1.1.1 USDT本位永续合约（主流）</h5>
<ul>
<li><strong>定义</strong>：以USDT进行结算的数字货币合约产品，是市场上最主流的永续合约类型</li>
<li><strong>合约面值</strong>：每张合约代表固定数量的标的数字货币（例如BTCUSDT合约，每张代表0.01BTC）</li>
<li><strong>结算货币</strong>：USDT（泰达币）</li>
<li><strong>杠杆倍数</strong>：0.01-100倍（支持1%到100倍的杠杆范围）</li>
<li><strong>核心优势</strong>：收益计算直观明了，以USDT计价，便于投资者理解盈亏状况</li>
</ul>
<h5 id="1-1-1-2-币本位永续合约（较少使用）">1.1.1.2 币本位永续合约（较少使用）</h5>
<ul>
<li><strong>定义</strong>：以BTC等加密货币进行结算的数字货币合约产品</li>
<li><strong>合约面值</strong>：每张合约代表价值100美元等值的标的资产</li>
<li><strong>结算货币</strong>：以标的加密货币本身进行结算（如BTC合约以BTC结算）</li>
<li><strong>杠杆倍数</strong>：0.01-100倍（与USDT本位合约相同的杠杆范围）</li>
<li><strong>适用场景</strong>：特别适合长期持有该币种的用户，如矿工等有套期保值需求的群体</li>
</ul>
<blockquote>
<p><strong>套期保值解释</strong>：套保是指通过衍生品交易对冲现货价格波动风险的策略，帮助投资者锁定收益或规避损失。</p>
</blockquote>
<h4 id="1-1-2-订单簿基础机制">1.1.2 订单簿基础机制</h4>
<h5 id="1-1-2-1-订单簿构成要素">1.1.2.1 订单簿构成要素</h5>
<p>订单簿（Order Book）是交易所展示买卖订单的实时列表，包含：</p>
<p><strong>基本性质</strong>：</p>
<ul>
<li><strong>价格精度（最小变动单位）</strong>：价格不能任意设置，必须是最小精度的整数倍
<ul>
<li>例如：价格精度为0.1，则只能报价50000.0、50000.1、50000.2…</li>
<li>不能报价50000.05或50000.15等中间值</li>
</ul>
</li>
<li><strong>离散性</strong>：正是因为价格精度的存在，才有了买一、买二等不同档位</li>
<li><strong>排序规则</strong>：同一价格档位的订单按时间优先原则排序</li>
</ul>
<p><strong>买卖盘结构</strong>：</p>
<ul>
<li><strong>买盘（Bid）</strong>：买入订单，价格从高到低排列
<ul>
<li>买一：最高买入价格及对应数量</li>
<li>买二、买三…：依次递减一个或多个最小精度单位的买入价格</li>
</ul>
</li>
<li><strong>卖盘（Ask）</strong>：卖出订单，价格从低到高排列
<ul>
<li>卖一：最低卖出价格及对应数量</li>
<li>卖二、卖三…：依次递增一个或多个最小精度单位的卖出价格</li>
</ul>
</li>
</ul>
<h5 id="1-1-2-2-关键术语定义">1.1.2.2 关键术语定义</h5>
<ul>
<li><strong>档位</strong>：订单簿中每一个价格水平及其对应的挂单数量</li>
<li><strong>深度</strong>：各档位的挂单总量，反映市场流动性</li>
<li><strong>买卖价差（Bid-Ask Spread）</strong>：买一价格与卖一价格的差值，反映市场流动性成本
<ul>
<li><strong>具体例子</strong>：买一价格49,950，卖一价格50,000，价差为50 USDT</li>
<li><strong>实际影响</strong>：若想立即买入，需按50,000价格成交；若想立即卖出，只能按49,950价格成交</li>
<li><strong>经济含义</strong>：这个价差就是立即成交需要支付的"流动性成本"，价差越小说明流动性越好</li>
</ul>
</li>
<li><strong>市场深度</strong>：大额交易对价格的冲击程度</li>
</ul>
<h5 id="1-1-2-3-订单簿结构示例">1.1.2.3 订单簿结构示例</h5>
<p><strong>图2 订单簿结构与价格档位分布</strong></p>
<pre class="mermaid">graph TB
    subgraph "卖盘 (Ask) - 价格从低到高"
        A3["卖三: 50,100 USDT<br>数量: 0.15"]
        A2["卖二: 50,050 USDT<br>数量: 0.25"]
        A1["卖一: 50,000 USDT<br>数量: 0.10"]
    end

    MP["当前价格: 49,975 USDT<br>买卖价差: 50 USDT"]

    subgraph "买盘 (Bid) - 价格从高到低"
        B1["买一: 49,950 USDT<br>数量: 0.20"]
        B2["买二: 49,900 USDT<br>数量: 0.30"]
        B3["买三: 49,850 USDT<br>数量: 0.40"]
    end

    A3 --&gt; A2 --&gt; A1 --&gt; MP --&gt; B1 --&gt; B2 --&gt; B3

    style A1 fill:#ffcdd2
    style A2 fill:#ffcdd2
    style A3 fill:#ffcdd2
    style B1 fill:#c8e6c9
    style B2 fill:#c8e6c9
    style B3 fill:#c8e6c9
    style MP fill:#fff3e0</pre>
<p>如图2所示，订单簿按照价格优先、时间优先的原则排列。卖盘价格从低到高排序，买盘价格从高到低排序，中间的价差反映了市场的流动性成本。</p>
<table>
<thead>
<tr>
<th>卖盘</th>
<th>价格</th>
<th>数量</th>
</tr>
</thead>
<tbody>
<tr>
<td></td>
<td>50,100</td>
<td>0.15</td>
</tr>
<tr>
<td>卖二</td>
<td>50,050</td>
<td>0.25</td>
</tr>
<tr>
<td>卖一</td>
<td>50,000</td>
<td>0.10</td>
</tr>
<tr>
<td><strong>当前价格</strong></td>
<td><strong>49,975</strong></td>
<td></td>
</tr>
<tr>
<td>买一</td>
<td>49,950</td>
<td>0.20</td>
</tr>
<tr>
<td>买二</td>
<td>49,900</td>
<td>0.30</td>
</tr>
<tr>
<td></td>
<td>49,850</td>
<td>0.40</td>
</tr>
</tbody>
</table>
<h2 id="2-永续合约交易机制">2. 永续合约交易机制</h2>
<p>本章节将系统地阐述永续合约的核心交易机制，包括开仓与平仓的操作原理、持仓模式的对比分析。通过深入探讨买卖模式与开平模式的差异及其适用场景，为交易者提供理论基础和实践指导。</p>
<h3 id="2-1-开仓与平仓操作">2.1 开仓与平仓操作</h3>
<p><strong>图3 开仓与平仓操作流程</strong></p>
<pre class="mermaid">graph LR
    subgraph "开仓操作"
        A1["买入开多<br>预期价格上涨"] --&gt; B1["建立多头仓位<br>价格上涨获利"]
        A2["卖出开空<br>预期价格下跌"] --&gt; B2["建立空头仓位<br>价格下跌获利"]
    end

    subgraph "平仓操作"
        C1["多头平仓<br>卖出合约"] --&gt; D1["结算盈亏<br>（当前价-开仓价）×张数"]
        C2["空头平仓<br>买入合约"] --&gt; D2["结算盈亏<br>（开仓价-当前价）×张数"]
    end

    B1 --&gt; C1
    B2 --&gt; C2

    style A1 fill:#c8e6c9
    style A2 fill:#ffcdd2
    style B1 fill:#c8e6c9
    style B2 fill:#ffcdd2
    style C1 fill:#e1f5fe
    style C2 fill:#e1f5fe
    style D1 fill:#fff3e0
    style D2 fill:#fff3e0</pre>
<p>如图3所示，永续合约的交易包括开仓和平仓两个基本操作。开仓时建立多头或空头仓位，平仓时通过反向操作结算盈亏。</p>
<h4 id="2-1-1-开仓机制原理">2.1.1 开仓机制原理</h4>
<ul>
<li><strong>开仓（开新仓位）</strong>：
<ul>
<li><strong>买入开多（做多）</strong>：预期价格上涨，买入合约建立多头仓位，盈利来源于价格上涨</li>
<li><strong>卖出开空（做空）</strong>：预期价格下跌，卖出合约建立空头仓位，盈利来源于价格下跌</li>
<li><strong>保证金机制</strong>：只需支付合约价值的一小部分作为保证金，通过杠杆放大收益和风险</li>
</ul>
</li>
</ul>
<h4 id="2-1-2-平仓机制原理">2.1.2 平仓机制原理</h4>
<ul>
<li><strong>平仓（关闭仓位）</strong>：
<ul>
<li><strong>多头平仓</strong>：卖出与持有多头仓位相等数量的合约</li>
<li><strong>空头平仓</strong>：买入与持有空头仓位相等数量的合约</li>
<li><strong>盈亏结算</strong>：平仓时根据开仓价格与平仓价格的差异计算实际盈亏</li>
</ul>
</li>
</ul>
<blockquote>
<p><strong>实例说明</strong>：假设BTC价格为50,000 USDT，用户用1,000 USDT保证金，10倍杠杆开多1个BTC的合约。如果BTC涨至55,000 USDT时平仓，盈利5,000 USDT；如果跌至45,000 USDT时平仓，亏损5,000 USDT（本金全部亏完）。</p>
</blockquote>
<h3 id="2-2-持仓模式对比分析">2.2 持仓模式对比分析</h3>
<p><strong>图4 持仓模式对比分析</strong></p>
<pre class="mermaid">graph TD
    A["持仓模式"] --&gt; B["买卖模式<br>（单向持仓）"]
    A --&gt; C["开平模式<br>（双向持仓）"]

    B --&gt; D["特点:<br>• 一个方向持仓<br>• 反向操作减少仓位<br>• 资金效率高"]

    C --&gt; E["特点:<br>• 同时持有多空<br>• 反向操作增加仓位<br>• 操作灵活性高"]

    subgraph "示例对比"
        F["初始: 10张多仓<br>操作: 卖出5张"]
        F --&gt; G["买卖模式结果:<br>5张多仓"]
        F --&gt; H["开平模式结果:<br>10张多仓 + 5张空仓"]
    end

    D --&gt; G
    E --&gt; H

    style B fill:#e1f5fe
    style C fill:#fff3e0
    style G fill:#c8e6c9
    style H fill:#ffeb3b</pre>
<p>如图4所示，买卖模式和开平模式的核心区别在于对反向操作的处理方式。买卖模式追求资金效率，而开平模式提供更高的操作灵活性。</p>
<h4 id="2-2-1-买卖模式（单向持仓）">2.2.1 买卖模式（单向持仓）</h4>
<ul>
<li>每个合约在一个保证金模式下只能有一个持仓方向（多仓或空仓）</li>
<li>反向操作会直接减少当前仓位</li>
<li>例如：持有10张BTCUSDT多仓，卖出5张后变成5张多仓</li>
</ul>
<h4 id="2-2-2-开平模式（双向持仓）">2.2.2 开平模式（双向持仓）</h4>
<ul>
<li>每个合约可以同时持有多仓和空仓</li>
<li>反向操作会建立新的相反仓位</li>
<li>例如：持有10张BTCUSDT多仓，卖出5张后变成10张多仓+5张空仓</li>
</ul>
<h4 id="2-2-3-本质差异分析">2.2.3 本质差异分析</h4>
<h5 id="2-2-3-1-净头寸相同">2.2.3.1 净头寸相同</h5>
<p>从最终盈亏角度，两种模式的净头寸效果相同：</p>
<ul>
<li>单向：10张多仓 - 5张卖出 = 5张净多仓</li>
<li>双向：10张多仓 + 5张空仓 = 5张净多仓</li>
</ul>
<h5 id="2-2-3-2-关键区别">2.2.3.2 关键区别</h5>
<ul>
<li><strong>保证金占用</strong>：
<ul>
<li>单向：只需为净头寸(5张)缴纳保证金</li>
<li>双向：需为总头寸(10+5=15张)分别缴纳保证金</li>
</ul>
</li>
<li><strong>资金费率</strong>：
<ul>
<li>单向：只对净头寸收取资金费用</li>
<li>双向：多仓和空仓分别收取资金费用（可能相互抵消）</li>
</ul>
</li>
<li><strong>操作灵活性</strong>：
<ul>
<li>单向：平仓需要精确计算数量</li>
<li>双向：可以保持原有仓位不动，独立管理对冲仓位</li>
</ul>
</li>
</ul>
<h4 id="2-2-4-适用场景分析">2.2.4 适用场景分析</h4>
<h5 id="2-2-4-1-单向持仓">2.2.4.1 单向持仓</h5>
<p><strong>适合场景</strong>：资金效率高，适合趋势交易</p>
<ul>
<li>明确看多或看空方向</li>
<li>追求最大资金利用率</li>
<li>简单的买入持有策略</li>
</ul>
<h5 id="2-2-4-2-双向持仓">2.2.4.2 双向持仓</h5>
<p><strong>成本考虑</strong>：更多保证金占用 + 双倍手续费 + 双倍资金费率</p>
<p><strong>价值场景</strong>：</p>
<ol>
<li><strong>套利策略</strong>：发现价差机会时，不影响原有仓位快速建立反向仓位</li>
<li><strong>风险锁定</strong>：持有长期多仓时，短期看跌可开空仓锁定收益，避免平掉长期仓位</li>
<li><strong>分层管理</strong>：不同时间周期的策略可以独立管理（如长期投资+短期交易）</li>
<li><strong>降低冲击</strong>：大仓位分批平仓时，可先开反向仓位对冲，再慢慢处理原仓位</li>
</ol>
<p><strong>决策考虑</strong>：只有当策略收益能够覆盖额外成本时，双向持仓才有意义</p>
<h2 id="3-价格发现与资金费率机制">3. 价格发现与资金费率机制</h2>
<p>本章节将深入分析永续合约的价格发现机制，包括资金费率的计算原理、标记价格与现货指数价格的关系。通过阐述资金费率如何确保合约价格与现货价格较合，以及标记价格的计算方法，建立对永续合约价格发现机制的整体认知。</p>
<h3 id="3-1-资金费率机制原理">3.1 资金费率机制原理</h3>
<p><strong>图5 资金费率机制作用原理</strong></p>
<pre class="mermaid">graph TD
    A["永续合约价格"] --&gt; B["与现货指数价格比较"]
    C["现货指数价格"] --&gt; B

    B --&gt; D{"合约价格 &gt; 现货价格?"}
    D --&gt;|是| E["资金费率为正<br>多头向空头支付"]
    D --&gt;|否| F["资金费率为负<br>空头向多头支付"]

    E --&gt; G["多头持仓成本增加<br>部分多头平仓"]
    F --&gt; H["空头持仓成本增加<br>部分空头平仓"]

    G --&gt; I["合约价格下降<br>向现货价格收敛"]
    H --&gt; J["合约价格上升<br>向现货价格收敛"]

    I --&gt; K["价格平衡机制"]
    J --&gt; K

    subgraph "结算时间"
        L["每8小时结算<br>UTC+8: 00:00, 08:00, 16:00"]
        M["只有结算时刻持有仓位<br>才需要支付或收取费用"]
    end

    subgraph "费用计算"
        N["资金费用 = 持仓仓位价值 × 资金费率"]
        O["仓位价值 = 合约张数 × 合约面值 × 标记价格"]
    end

    style E fill:#ffcdd2
    style F fill:#c8e6c9
    style K fill:#e1f5fe
    style L fill:#fff3e0
    style M fill:#fff3e0
    style N fill:#f3e5f5
    style O fill:#f3e5f5</pre>
<p>如图5所示，资金费率机制通过多空双方的资金流动，形成负反馈调节机制，确保合约价格向现货价格收敛，维持价格发现功能。</p>
<h4 id="3-1-1-基本概念与作用">3.1.1 基本概念与作用</h4>
<ul>
<li><strong>定义</strong>：为确保永续合约价格与现货指数价格保持一致而设立的机制</li>
<li><strong>结算时间</strong>：通常每8小时或4小时结算一次，具体时间以合约信息为准（如UTC+8的00:00、08:00、16:00）</li>
<li><strong>费率方向</strong>：
<ul>
<li>正费率：多头（看涨方向，买入开仓的投资者）向空头（看跌方向，卖出开仓的投资者）支付费用</li>
<li>负费率：空头（看跌方向，卖出开仓的投资者）向多头（看涨方向，买入开仓的投资者）支付费用</li>
</ul>
</li>
<li><strong>重要提醒</strong>：只有在结算时刻持有仓位才需要支付或收取资金费用</li>
</ul>
<blockquote>
<p>投资者可以在结算前平仓离场来避免支付资金费用，这为短期交易者提供了灵活的套利机会</p>
</blockquote>
<h4 id="3-1-2-计算原理与趋势机制">3.1.2 计算原理与趋势机制</h4>
<h5 id="3-1-2-1-基本思想">3.1.2.1 基本思想</h5>
<p>通过多空双方的资金流动，使永续合约价格向现货指数价格收敛，确保合约价格合理反映标的资产价值</p>
<h5 id="3-1-2-2-趋势机制">3.1.2.2 趋势机制</h5>
<p>设合约价格为x，现货指数价格为y：</p>
<ul>
<li>当x &gt; y时：多头支付费用→卖压增加→x趋向下降至y</li>
<li>当x &lt; y时：空头支付费用→买压增加→x趋向上升至y</li>
<li>当|x-y|越大时：资金费率绝对值越大→价格修正力度越强</li>
<li>当x ≈ y时：资金费率接近基础利率→价格保持相对稳定</li>
</ul>
<h4 id="3-1-3-具体算法（OKX采用新版计算逻辑）">3.1.3 具体算法（OKX采用新版计算逻辑）</h4>
<p><strong>公式1 资金费率计算公式</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>资金费率</mtext><mo>=</mo><mtext>clamp</mtext><mo stretchy="false">[</mo><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo>+</mo><mtext>clamp</mtext><mo stretchy="false">(</mo><mi>r</mi><mo>−</mo><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo separator="true">,</mo><mn>0.05</mn><mi mathvariant="normal">%</mi><mo separator="true">,</mo><mo>−</mo><mn>0.05</mn><mi mathvariant="normal">%</mi><mo stretchy="false">)</mo><mo separator="true">,</mo><msub><mi>F</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo separator="true">,</mo><msub><mi>F</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">\text{资金费率} = \text{clamp}[\overline{P} + \text{clamp}(r - \overline{P}, 0.05\%, -0.05\%), F_{max}, F_{min}]
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">资金费率</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1333em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">clamp</span></span><span class="mopen">[</span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">clamp</span></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1333em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.05%</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">−</span><span class="mord">0.05%</span><span class="mclose">)</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span></span></p>
<h5 id="3-1-3-1-公式设计思想">3.1.3.1 公式设计思想</h5>
<ol>
<li>
<p><strong>市场偏离检测</strong>：通过<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>（平均溢价指数）判断合约价格相对现货的偏离方向和程度</p>
</li>
<li>
<p><strong>基准利率设计逻辑</strong>：</p>
<ul>
<li><strong>为什么是0.03%/天</strong>：
<ul>
<li><strong>经济学原理</strong>：多头持仓类似"借钱买资产"，空头持仓类似"出借资产收租金"</li>
<li><strong>奖励空头</strong>：在理想均衡状态下，空头方承担了"出借风险"，应获得0.03%/天的基础收益</li>
<li><strong>成本多头</strong>：多头方享受了"杠杆便利"，应支付0.03%/天的资金使用成本</li>
<li><strong>参考基准</strong>：接近传统金融市场的短期利率水平</li>
</ul>
</li>
<li><strong>中性参考点概念</strong>：当合约价格=现货价格时，资金费率应等于基准利率<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>（多头向空头支付基础利率）</li>
<li><strong>修正力度计算</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>−</mo><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r - \overline{P})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1333em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>的趋势意义：
<ul>
<li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo>&gt;</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">\overline{P} &gt; r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9224em;vertical-align:-0.0391em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>时：合约溢价过高 → <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>−</mo><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(r - \overline{P}) &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1333em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> → 虽然修正项为负，但<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>本身是正大值 → 最终费率 = 大正数 + 小负数 = 仍为正且较大 → 多头付更多费用</li>
<li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo>&lt;</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">\overline{P} &lt; r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9224em;vertical-align:-0.0391em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>时：合约溢价过低 → <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>−</mo><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">(r - \overline{P}) &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1333em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> → 修正项为正 → 如果<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>为负，最终费率可能为负 → 空头付费用</li>
<li>当<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo>≈</mo><mi>r</mi></mrow><annotation encoding="application/x-tex">\overline{P} ≈ r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">≈</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>时：市场均衡 → 修正力度接近0 → 费率 ≈ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span> + 0 = 基准利率（多头向空头支付）</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>双重平滑机制</strong>：</p>
<ul>
<li>内层clamp：限制单次修正幅度在±0.05%，避免费率剧烈波动</li>
<li>外层clamp：确保费率在交易所风控范围内</li>
</ul>
</li>
<li>
<p><strong>自动平衡效果</strong>：整个机制形成负反馈循环，自动将合约价格拉回现货价格附近</p>
</li>
</ol>
<h5 id="3-1-3-2-公式符号说明">3.1.3.2 公式符号说明</h5>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover></mrow><annotation encoding="application/x-tex">\overline{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8833em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span></span></span></span>：平均溢价指数</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi></mrow><annotation encoding="application/x-tex">r</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span>：基础利率 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mrow><mn>0.03</mn><mi mathvariant="normal">%</mi></mrow><mrow><mn>24</mn><mi mathvariant="normal">/</mi><mi>T</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\frac{0.03\%}{24/T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.439em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.919em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">24/</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.03%</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>T</mi></mrow><annotation encoding="application/x-tex">T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span></span></span></span>为结算周期小时数</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：资金费率上限</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>F</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub></mrow><annotation encoding="application/x-tex">F_{min}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：资金费率下限</li>
</ul>
<h5 id="3-1-3-3-计算步骤">3.1.3.3 计算步骤</h5>
<p><strong>第1步：计算基础利率</strong><br>
<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mfrac><mrow><mn>0.03</mn><mi mathvariant="normal">%</mi></mrow><mrow><mn>24</mn><mi mathvariant="normal">/</mi><mi>T</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">r = \frac{0.03\%}{24/T}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.439em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.919em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">24/</span><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.03%</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span>，例如8小时结算周期：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>r</mi><mo>=</mo><mfrac><mrow><mn>0.03</mn><mi mathvariant="normal">%</mi></mrow><mrow><mn>24</mn><mi mathvariant="normal">/</mi><mn>8</mn></mrow></mfrac><mo>=</mo><mn>0.01</mn><mi mathvariant="normal">%</mi></mrow><annotation encoding="application/x-tex">r = \frac{0.03\%}{24/8} = 0.01\%</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.439em;vertical-align:-0.52em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.919em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">24/8</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">0.03%</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.52em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">0.01%</span></span></span></span></p>
<p><strong>第2步：计算溢价指数</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo>=</mo><mfrac><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>P</mi><mi>b</mi></msub><mo>−</mo><mi>I</mi><mo stretchy="false">)</mo><mo>−</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo>−</mo><msub><mi>P</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><mi>I</mi></mfrac></mrow><annotation encoding="application/x-tex">P = \frac{\max(0, P_b - I) - \max(0, I - P_s)}{I}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><strong>溢价指数公式思想</strong>：</p>
<ul>
<li><strong>分子设计</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>P</mi><mi>b</mi></msub><mo>−</mo><mi>I</mi><mo stretchy="false">)</mo><mo>−</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo>−</mo><msub><mi>P</mi><mi>s</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\max(0, P_b - I) - \max(0, I - P_s)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>
<ul>
<li>第一项：当买方愿意高于指数价格购买时，反映多头热情（正溢价）</li>
<li>第二项：当卖方愿意低于指数价格出售时，反映空头热情（负溢价贡献）</li>
<li>整体：衡量合约市场相对现货的"温度"</li>
</ul>
</li>
<li><strong>分母归一化</strong>：除以<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>得到相对偏离比例，便于不同价格水平的比较</li>
<li><strong>结果解读</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P &gt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>表示合约被高估，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo>&lt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">P &lt; 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7224em;vertical-align:-0.0391em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>表示合约被低估</li>
</ul>
<p><strong>符号定义</strong>：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex">P_b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：深度加权买价（Depth-weighted bid price）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>s</mi></msub></mrow><annotation encoding="application/x-tex">P_s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：深度加权卖价（Depth-weighted ask price）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>：现货指数价格</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>：深度加权金额 = <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>200</mn><mo>×</mo><msub><mi>L</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">200 \times L_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">200</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>（<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>L</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub></mrow><annotation encoding="application/x-tex">L_{max}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">L</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>为合约最高杠杆倍数）
<ul>
<li>例如：BTCUSDT合约最高杠杆100倍，则<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi><mo>=</mo><mn>200</mn><mo>×</mo><mn>100</mn><mo>=</mo><mn>20</mn><mo separator="true">,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">D = 200 \times 100 = 20,000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">200</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">100</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">20</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span></span> USDT</li>
<li>意思是：模拟用20,000 USDT去买入BTC时的平均成交价格</li>
</ul>
</li>
</ul>
<p><strong>深度加权价格计算</strong>：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>P</mi><mi>b</mi></msub><mo>=</mo><mfrac><mi>D</mi><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>q</mi><mi>i</mi></msub></mrow></mfrac><mo separator="true">,</mo><mspace width="1em"></mspace><mtext>其中</mtext><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><msub><mi>p</mi><mi>i</mi></msub><mo>⋅</mo><msub><mi>q</mi><mi>i</mi></msub><mo>=</mo><mi>D</mi></mrow><annotation encoding="application/x-tex">P_b = \frac{D}{\sum_{i=1}^{n} q_i}, \quad \text{其中} \sum_{i=1}^{n} p_i \cdot q_i = D
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.9291em;vertical-align:-1.2777em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:1em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord cjk_fallback">其中</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">p_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>档买单价格</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">q_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>档买单数量</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>：达到深度加权金额<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>所需的档位数</li>
</ul>
<p><strong>计算步骤</strong>：从订单簿最优价格开始，逐档累加直至总价值达到<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>D</mi></mrow><annotation encoding="application/x-tex">D</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span></span></span></span>，然后计算加权平均价格</p>
<p><strong>第3步：计算平均溢价指数</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">(</mo><msub><mi>T</mi><mi>n</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>i</mi><mo>⋅</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></munderover><mi>i</mi></mrow></mfrac></mrow><annotation encoding="application/x-tex">\overline{P}(T_n) = \frac{\sum_{i=1}^{n} i \cdot P(T_i)}{\sum_{i=1}^{n} i}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1333em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.488em;vertical-align:-0.994em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.494em;"><span style="top:-2.3057em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">i</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.994em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(T_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>：第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>分钟时刻的溢价指数（使用步骤2的公式计算）<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>=</mo><mfrac><mrow><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><msub><mi>P</mi><mi>b</mi></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><mi>I</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>−</mo><mi>max</mi><mo>⁡</mo><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi>I</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>−</mo><msub><mi>P</mi><mi>s</mi></msub><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo stretchy="false">)</mo></mrow><mrow><mi>I</mi><mo stretchy="false">(</mo><msub><mi>T</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow></mfrac></mrow><annotation encoding="application/x-tex">P(T_i) = \frac{\max(0, P_b(T_i) - I(T_i)) - \max(0, I(T_i) - P_s(T_i))}{I(T_i)}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.363em;vertical-align:-0.936em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop">max</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mop">max</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">s</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">))</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.936em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>T</mi><mi>n</mi></msub></mrow><annotation encoding="application/x-tex">T_n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：当前时刻（距离结算周期开始第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>n</mi></mrow><annotation encoding="application/x-tex">n</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">n</span></span></span></span>分钟）</li>
<li>权重：时间越近，权重越大（第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>分钟的权重为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>）</li>
<li>例如：8小时结算周期，在第480分钟时计算，使用过去480分钟的溢价指数数据</li>
</ul>
<p><strong>第4步：应用双重限制</strong></p>
<ul>
<li>内层限制：将<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">(</mo><mi>r</mi><mo>−</mo><mover accent="true"><mi>P</mi><mo stretchy="true">‾</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">(r - \overline{P})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1.1333em;vertical-align:-0.25em;"></span><span class="mord overline"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8833em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span></span></span><span style="top:-3.8033em;"><span class="pstrut" style="height:3em;"></span><span class="overline-line" style="border-bottom-width:0.04em;"></span></span></span></span></span></span><span class="mclose">)</span></span></span></span>限制在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><mo>−</mo><mn>0.05</mn><mi mathvariant="normal">%</mi><mo separator="true">,</mo><mn>0.05</mn><mi mathvariant="normal">%</mi><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[-0.05\%, 0.05\%]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord">−</span><span class="mord">0.05%</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0.05%</span><span class="mclose">]</span></span></span></span>区间</li>
<li>外层限制：将最终结果限制在<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mi>F</mi><mrow><mi>m</mi><mi>i</mi><mi>n</mi></mrow></msub><mo separator="true">,</mo><msub><mi>F</mi><mrow><mi>m</mi><mi>a</mi><mi>x</mi></mrow></msub><mo stretchy="false">]</mo></mrow><annotation encoding="application/x-tex">[F_{min}, F_{max}]</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">min</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">ma</span><span class="mord mathnormal mtight">x</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span></span></span></span>区间</li>
</ul>
<h3 id="3-2-标记价格与现货指数价格计算">3.2 标记价格与现货指数价格计算</h3>
<h4 id="3-2-1-现货指数价格计算">3.2.1 现货指数价格计算</h4>
<p><strong>公式2 现货指数价格计算公式</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>I</mi><mo>=</mo><mfrac><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>w</mi><mi>i</mi></msub><mo>⋅</mo><msubsup><mi>P</mi><mi>i</mi><mrow><mi>a</mi><mi>d</mi><mi>j</mi></mrow></msubsup></mrow><mrow><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>N</mi></munderover><msub><mi>w</mi><mi>i</mi></msub></mrow></mfrac></mrow><annotation encoding="application/x-tex">I = \frac{\sum_{i=1}^{N} w_i \cdot P_i^{adj}}{\sum_{i=1}^{N} w_i}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.8419em;vertical-align:-1.1709em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6709em;"><span style="top:-2.1288em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.6897em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.9812em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.10903em;">N</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.967em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.1709em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<h5 id="3-2-1-1-公式符号说明">3.2.1.1 公式符号说明</h5>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>：现货指数价格（Index Price）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi></mrow><annotation encoding="application/x-tex">N</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span></span></span></span>：参与计算的有效交易所总数</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">w_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>个交易所的预设权重（基于流动性、稳定性等因素确定）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>个交易所的原始现货价格</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>P</mi><mi>i</mi><mrow><mi>a</mi><mi>d</mi><mi>j</mi></mrow></msubsup></mrow><annotation encoding="application/x-tex">P_i^{adj}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2439em;vertical-align:-0.2769em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.967em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span></span></span></span>：第<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi></mrow><annotation encoding="application/x-tex">i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6595em;"></span><span class="mord mathnormal">i</span></span></span></span>个交易所经过异常处理后的调整价格</li>
</ul>
<h5 id="3-2-1-2-基础计算规则">3.2.1.2 基础计算规则</h5>
<ul>
<li><strong>数据获取</strong>：实时从指定交易所检索相应交易对价格，受API速率限制</li>
<li><strong>交易所筛选</strong>：排除维护中或未及时更新价格的交易所</li>
<li><strong>合约类型区分</strong>：
<ul>
<li>USDT本位合约：使用相应标的的USDT指数价格</li>
<li>USDC本位合约：使用相应标的的USDC指数价格</li>
<li>币本位合约：使用标的资产的USD等值现货指数价格</li>
</ul>
</li>
</ul>
<h5 id="3-2-1-3-分级加权机制">3.2.1.3 分级加权机制</h5>
<ul>
<li>
<p><strong>≥3个交易所可用</strong>：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msubsup><mi>P</mi><mi>i</mi><mrow><mi>a</mi><mi>d</mi><mi>j</mi></mrow></msubsup><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.36em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>0.98</mn><mo>×</mo><mi>M</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>如果&nbsp;</mtext><msub><mi>P</mi><mi>i</mi></msub><mo>&lt;</mo><mn>0.98</mn><mi>M</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mn>1.02</mn><mo>×</mo><mi>M</mi></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext>如果&nbsp;</mtext><msub><mi>P</mi><mi>i</mi></msub><mo>&gt;</mo><mn>1.02</mn><mi>M</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><msub><mi>P</mi><mi>i</mi></msub></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mtext>其他情况</mtext></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">P_i^{adj} = \begin{cases}
0.98 \times M &amp; \text{如果 } P_i &lt; 0.98M \\
1.02 \times M &amp; \text{如果 } P_i &gt; 1.02M \\
P_i &amp; \text{其他情况}
\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.2439em;vertical-align:-0.2769em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.967em;"><span style="top:-2.4231em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span><span style="top:-3.1809em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.05724em;">j</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2769em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:4.32em;vertical-align:-1.91em;"></span><span class="minner"><span class="mopen"><span class="delimsizing mult"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.35em;"><span style="top:-2.2em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎩</span></span></span><span style="top:-2.192em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"></path></svg></span></span><span style="top:-3.15em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎨</span></span></span><span style="top:-4.292em;"><span class="pstrut" style="height:3.15em;"></span><span style="height:0.316em;width:0.8889em;"><svg xmlns="http://www.w3.org/2000/svg" width="0.8889em" height="0.316em" style="width:0.8889em" viewBox="0 0 888.89 316" preserveAspectRatio="xMinYMin"><path d="M384 0 H504 V316 H384z M384 0 H504 V316 H384z"></path></svg></span></span><span style="top:-4.6em;"><span class="pstrut" style="height:3.15em;"></span><span class="delimsizinginner delim-size4"><span>⎧</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.85em;"><span></span></span></span></span></span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">0.98</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1.02</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.41em;"><span style="top:-4.41em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">如果</span><span class="mord">&nbsp;</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&lt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">0.98</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span><span style="top:-2.97em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">如果</span><span class="mord">&nbsp;</span></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">&gt;</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mord">1.02</span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span><span style="top:-1.53em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">其他情况</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.91em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>M</mi></mrow><annotation encoding="application/x-tex">M</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">M</span></span></span></span>为所有交易所价格的中位数</p>
</li>
<li>
<p><strong>2个交易所可用</strong>：等权重加权 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>w</mi><mn>1</mn></msub><mo>=</mo><msub><mi>w</mi><mn>2</mn></msub><mo>=</mo><mn>0.5</mn></mrow><annotation encoding="application/x-tex">w_1 = w_2 = 0.5</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.02691em;">w</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0269em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.5</span></span></span></span></p>
</li>
<li>
<p><strong>1个交易所可用</strong>：直接使用该交易所价格 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><msub><mi>P</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">I = P_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p>
</li>
</ul>
<h5 id="3-2-1-4-异常价格处理">3.2.1.4 异常价格处理</h5>
<ul>
<li><strong>偏差检测</strong>：当交易所价格与中位数偏差超过±2%时触发</li>
<li><strong>价格修正</strong>：将异常价格调整至中位数的98%或102%</li>
<li><strong>动态调整</strong>：OKX可自行调整、增加、删除或替换交易所成分</li>
</ul>
<h4 id="3-2-2-标记价格计算">3.2.2 标记价格计算</h4>
<p><strong>公式3 标记价格计算公式</strong></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>标记价格</mtext><mo>=</mo><mi>I</mi><mo>+</mo><mtext>基差移动平均值</mtext></mrow><annotation encoding="application/x-tex">\text{标记价格} = I + \text{基差移动平均值}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">标记价格</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">基差移动平均值</span></span></span></span></span></span></p>
<h5 id="3-2-2-1-基差移动平均值计算">3.2.2.1 基差移动平均值计算</h5>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>基差移动平均值</mtext><mo>=</mo><mtext>MA</mtext><mrow><mo fence="true">(</mo><mfrac><mrow><msub><mi>P</mi><mrow><mi>b</mi><mi>i</mi><mi>d</mi></mrow></msub><mo>+</mo><msub><mi>P</mi><mrow><mi>a</mi><mi>s</mi><mi>k</mi></mrow></msub></mrow><mn>2</mn></mfrac><mo>−</mo><mi>I</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{基差移动平均值} = \text{MA}\left(\frac{P_{bid} + P_{ask}}{2} - I\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">基差移动平均值</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord text"><span class="mord">MA</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bi</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p>
<h5 id="3-2-2-2-计算方法详解">3.2.2.2 计算方法详解</h5>
<p>根据行业标准和OKX的实际实现，标记价格通常采用 <strong>指数移动平均（EMA）</strong> 方法计算基差移动平均值：</p>
<p><strong>完整计算公式</strong>：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>标记价格</mtext><mo>=</mo><mi>I</mi><mo>+</mo><mtext>EMA</mtext><mo stretchy="false">(</mo><mtext>基差</mtext><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{标记价格} = I + \text{EMA}(\text{基差})
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">标记价格</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">EMA</span></span><span class="mopen">(</span><span class="mord text"><span class="mord cjk_fallback">基差</span></span><span class="mclose">)</span></span></span></span></span></p>
<p><strong>或者表示为</strong>：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mtext>标记价格</mtext><mo>=</mo><mi>I</mi><mo>+</mo><mtext>EMA</mtext><mrow><mo fence="true">(</mo><mfrac><mrow><msub><mi>P</mi><mrow><mi>b</mi><mi>i</mi><mi>d</mi></mrow></msub><mo>+</mo><msub><mi>P</mi><mrow><mi>a</mi><mi>s</mi><mi>k</mi></mrow></msub></mrow><mn>2</mn></mfrac><mo>−</mo><mi>I</mi><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">\text{标记价格} = I + \text{EMA}\left(\frac{P_{bid} + P_{ask}}{2} - I\right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord cjk_fallback">标记价格</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7667em;vertical-align:-0.0833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:2.4em;vertical-align:-0.95em;"></span><span class="mord text"><span class="mord">EMA</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size3">(</span></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3603em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bi</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size3">)</span></span></span></span></span></span></span></p>
<p><strong>1. 数据采样与基差计算</strong>：</p>
<ul>
<li><strong>采样频率</strong>：按固定时间间隔（通常每秒或每几秒）采集数据</li>
<li><strong>基差计算</strong>：<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>基差</mtext><mi>t</mi></msub><mo>=</mo><mfrac><mrow><msub><mi>P</mi><mrow><mi>b</mi><mi>i</mi><mi>d</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo><mo>+</mo><msub><mi>P</mi><mrow><mi>a</mi><mi>s</mi><mi>k</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><mn>2</mn></mfrac><mo>−</mo><mi>I</mi><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\text{基差}_t = \frac{P_{bid}(t) + P_{ask}(t)}{2} - I(t)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">基差</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:2.113em;vertical-align:-0.686em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.427em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">2</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bi</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span></span></p>
</li>
</ul>
<p>其中<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>表示时间点，<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>b</mi><mi>i</mi><mi>d</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_{bid}(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bi</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>和<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>a</mi><mi>s</mi><mi>k</mi></mrow></msub><mo stretchy="false">(</mo><mi>t</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P_{ask}(t)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">t</span><span class="mclose">)</span></span></span></span>分别为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span>时刻的合约最优买价和卖价</p>
<p><strong>2. 指数移动平均（EMA）计算</strong>：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mtext>EMA</mtext><mi>t</mi></msub><mo>=</mo><mi>α</mi><mo>⋅</mo><msub><mtext>基差</mtext><mi>t</mi></msub><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>−</mo><mi>α</mi><mo stretchy="false">)</mo><mo>⋅</mo><msub><mtext>EMA</mtext><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\text{EMA}_{t} = \alpha \cdot \text{基差}_t + (1-\alpha) \cdot \text{EMA}_{t-1}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">EMA</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4445em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">基差</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord text"><span class="mord">EMA</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong>EMA参数说明</strong>：</p>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>：平滑系数，通常在0.1-0.3之间</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>越大，对近期数据权重越高，价格反应越灵敏</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span></span></span></span>越小，价格更加平滑，但反应较慢</li>
<li>初始值：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>EMA</mtext><mn>0</mn></msub><mo>=</mo><msub><mtext>基差</mtext><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\text{EMA}_0 = \text{基差}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">EMA</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">基差</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
</ul>
<p><strong>3. EMA相对于其他移动平均的优势</strong>：</p>
<ul>
<li><strong>简单移动平均（SMA）</strong>：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>SMA</mtext><mo>=</mo><mfrac><mn>1</mn><mi>n</mi></mfrac><msubsup><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>n</mi></msubsup><msub><mtext>基差</mtext><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">\text{SMA} = \frac{1}{n}\sum_{i=1}^{n}\text{基差}_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">SMA</span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop op-symbol small-op" style="position:relative;top:0em;">∑</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8043em;"><span style="top:-2.4003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.2029em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2997em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">基差</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>
<ul>
<li>优点：计算简单，平滑效果好</li>
<li>缺点：对所有历史数据等权重，反应迟钝</li>
</ul>
</li>
<li><strong>指数移动平均（EMA）</strong>：对近期数据给予更高权重
<ul>
<li>优点：响应速度快，更好地跟踪市场变化</li>
<li>缺点：对噪声相对敏感</li>
</ul>
</li>
<li><strong>时间加权平均（TWA）</strong>：根据时间间隔进行加权
<ul>
<li>优点：考虑时间因素，适合不规则采样</li>
<li>缺点：计算复杂度较高</li>
</ul>
</li>
</ul>
<p><strong>4. 实际实现参数</strong>：</p>
<ul>
<li><strong>窗口期选择</strong>：EMA的有效窗口期约为<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mfrac><mn>2</mn><mi>α</mi></mfrac><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">\frac{2}{\alpha} - 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.1901em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8451em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.394em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>个采样点</li>
<li><strong>异常数据处理</strong>：设置基差上下限，过滤极端值（如±5%）</li>
<li><strong>实时更新频率</strong>：每秒更新1-5次，确保标记价格的准确性</li>
<li><strong>初始化方式</strong>：系统启动时使用前N个基差值的SMA作为EMA初始值</li>
</ul>
<p><strong>5. 计算示例</strong>：<br>
假设<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.2</mn></mrow><annotation encoding="application/x-tex">\alpha = 0.2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0.2</span></span></span></span>，某时刻数据如下：</p>
<ul>
<li>合约买一价：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>b</mi><mi>i</mi><mi>d</mi></mrow></msub><mo>=</mo><mn>50</mn><mo separator="true">,</mo><mn>100</mn></mrow><annotation encoding="application/x-tex">P_{bid} = 50,100</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bi</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">50</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">100</span></span></span></span> USDT</li>
<li>合约卖一价：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>a</mi><mi>s</mi><mi>k</mi></mrow></msub><mo>=</mo><mn>50</mn><mo separator="true">,</mo><mn>200</mn></mrow><annotation encoding="application/x-tex">P_{ask} = 50,200</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">50</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">200</span></span></span></span> USDT</li>
<li>指数价格：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi><mo>=</mo><mn>50</mn><mo separator="true">,</mo><mn>000</mn></mrow><annotation encoding="application/x-tex">I = 50,000</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">50</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span></span></span></span> USDT</li>
<li>上一时刻EMA：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>EMA</mtext><mrow><mi>t</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>=</mo><mn>180</mn></mrow><annotation encoding="application/x-tex">\text{EMA}_{t-1} = 180</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8917em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord text"><span class="mord">EMA</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">−</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">180</span></span></span></span> USDT</li>
</ul>
<p>计算过程：</p>
<ol>
<li>基差：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>基差</mtext><mi>t</mi></msub><mo>=</mo><mfrac><mrow><mn>50</mn><mo separator="true">,</mo><mn>100</mn><mo>+</mo><mn>50</mn><mo separator="true">,</mo><mn>200</mn></mrow><mn>2</mn></mfrac><mo>−</mo><mn>50</mn><mo separator="true">,</mo><mn>000</mn><mo>=</mo><mn>150</mn></mrow><annotation encoding="application/x-tex">\text{基差}_t = \frac{50,100 + 50,200}{2} - 50,000 = 150</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord cjk_fallback">基差</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.2422em;vertical-align:-0.345em;"></span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.8972em;"><span style="top:-2.655em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.4461em;"><span class="pstrut" style="height:3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">50</span><span class="mpunct mtight">,</span><span class="mord mtight">100</span><span class="mbin mtight">+</span><span class="mord mtight">50</span><span class="mpunct mtight">,</span><span class="mord mtight">200</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.345em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">50</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">150</span></span></span></span> USDT</li>
<li>新EMA：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mtext>EMA</mtext><mi>t</mi></msub><mo>=</mo><mn>0.2</mn><mo>×</mo><mn>150</mn><mo>+</mo><mn>0.8</mn><mo>×</mo><mn>180</mn><mo>=</mo><mn>174</mn></mrow><annotation encoding="application/x-tex">\text{EMA}_t = 0.2 \times 150 + 0.8 \times 180 = 174</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord text"><span class="mord">EMA</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.2</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">150</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.7278em;vertical-align:-0.0833em;"></span><span class="mord">0.8</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">180</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">174</span></span></span></span> USDT</li>
<li>标记价格：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>50</mn><mo separator="true">,</mo><mn>000</mn><mo>+</mo><mn>174</mn><mo>=</mo><mn>50</mn><mo separator="true">,</mo><mn>174</mn></mrow><annotation encoding="application/x-tex">50,000 + 174 = 50,174</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">50</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">000</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">174</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">50</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">174</span></span></span></span> USDT</li>
</ol>
<h5 id="3-2-2-3-为什么不直接用指数价格，还要加基差移动平均值？">3.2.2.3 为什么不直接用指数价格，还要加基差移动平均值？</h5>
<p><strong>直接使用指数价格的问题</strong>：</p>
<ul>
<li>
<p><strong>脱离合约市场实际情况</strong>：</p>
<ul>
<li>指数价格反映的是现货市场价格</li>
<li>合约市场有自己的供需关系，价格可能系统性偏离现货</li>
<li>例如：现货BTC价格50,000，但合约市场看涨情绪强烈，持续交易在50,200附近</li>
<li>如果强制平仓按50,000指数价格执行，与实际合约成交价差距过大</li>
</ul>
</li>
<li>
<p><strong>忽略市场流动性差异</strong>：</p>
<ul>
<li>现货市场和合约市场的流动性、参与者结构不同</li>
<li>合约市场可能因为杠杆、资金费率等因素，价格持续性偏离现货</li>
<li>直接用指数价格不能反映合约市场的真实交易成本</li>
</ul>
</li>
</ul>
<p><strong>加入基差移动平均值的作用</strong>：</p>
<ul>
<li>
<p><strong>反映合约市场真实价格水平</strong>：</p>
<ul>
<li>基差 = 合约价格 - 指数价格，体现合约相对现货的溢价/折价</li>
<li>移动平均基差 = 合约市场相对现货的"稳定偏离度"</li>
<li>标记价格 = 指数价格 + 基差移动平均值 ≈ 合约市场的"真实均衡价格"</li>
</ul>
</li>
<li>
<p><strong>平衡准确性与稳定性</strong>：</p>
<ul>
<li>如果基差移动平均值为+200，说明合约市场系统性高于现货200</li>
<li>此时标记价格 = 指数价格 + 200，更接近合约真实交易价格</li>
<li>但通过移动平均，避免了单笔交易造成的剧烈波动</li>
</ul>
</li>
</ul>
<h5 id="3-2-2-4-实际案例对比">3.2.2.4 实际案例对比</h5>
<ul>
<li>指数价格：50,000 USDT（现货平均价）</li>
<li>合约近期交易：50,180-50,220（持续偏高）</li>
<li>基差移动平均值：+200 USDT</li>
<li>标记价格：50,000 + 200 = 50,200 USDT</li>
<li>这样的标记价格既贴近合约市场实际，又避免了极端波动影响</li>
</ul>
<h5 id="3-2-2-5-符号说明">3.2.2.5 符号说明</h5>
<ul>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>：现货指数价格（同前面计算的指数价格）</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>b</mi><mi>i</mi><mi>d</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{bid}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">bi</span><span class="mord mathnormal mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：合约买一价</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>a</mi><mi>s</mi><mi>k</mi></mrow></msub></mrow><annotation encoding="application/x-tex">P_{ask}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:-0.1389em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight">s</span><span class="mord mathnormal mtight" style="margin-right:0.03148em;">k</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>：合约卖一价</li>
<li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>MA</mtext></mrow><annotation encoding="application/x-tex">\text{MA}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord text"><span class="mord">MA</span></span></span></span></span>：移动平均值（Moving Average）</li>
</ul>
<h5 id="3-2-2-6-算法设计思想">3.2.2.6 算法设计思想</h5>
<ol>
<li><strong>基差概念</strong>：合约中间价与指数价格的差值，反映合约相对现货的溢价或折价</li>
<li><strong>移动平均平滑</strong>：通过移动平均值机制过滤短时间内的合约价格波动</li>
<li><strong>防操纵功能</strong>：减少异常波动产生的不必要强制平仓，避免单笔交易操纵价格</li>
</ol>
<h5 id="3-2-2-7-与最新价格的区别">3.2.2.7 与最新价格的区别</h5>
<ul>
<li><strong>最新价格</strong>：由订单簿中最新成交价格决定，可能受到单笔大额交易影响</li>
<li><strong>标记价格</strong>：基于指数价格和基差移动平均值，更稳定，用于：
<ul>
<li>计算未实现盈亏</li>
<li>强制平仓判断</li>
<li>保证金计算</li>
</ul>
</li>
</ul>
<h4 id="3-2-3-两者关系总结">3.2.3 两者关系总结</h4>
<ul>
<li><strong>数据源相同</strong>：都基于多个现货交易所的价格数据</li>
<li><strong>算法差异</strong>：标记价格在指数价格基础上增加了合约市场的风险控制逻辑</li>
<li><strong>用途分工</strong>：
<ul>
<li>现货指数价格(<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>I</mi></mrow><annotation encoding="application/x-tex">I</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07847em;">I</span></span></span></span>)：资金费率计算的基准</li>
<li>标记价格：风险管理（盈亏计算、强制平仓）的基准</li>
</ul>
</li>
<li><strong>数值关系</strong>：正常情况下非常接近，极端市场条件下可能有差异</li>
</ul>
<h2 id="4-实例计算与保证金制度">4. 实例计算与保证金制度</h2>
<p>本章节通过具体的合约实例和计算案例，帮助读者理解永续合约的实际操作。同时详细介绍了杠杆与保证金制度的具体规则，为交易者提供风险管理的实用指导。以TONUSDT永续合约为例，展示完整的收益计算过程和资金费用计算方法，并深入分析全仓与逐仓保证金模式的差异，为交易者提供实践中的参考依据。</p>
<h3 id="4-1-合约规格与收益计算">4.1 合约规格与收益计算</h3>
<h4 id="4-1-1-合约规格示例">4.1.1 合约规格示例</h4>
<h5 id="4-1-1-1-TONUSDT永续合约规格">4.1.1.1 TONUSDT永续合约规格</h5>
<p>以<strong>TONUSDT永续合约</strong>为例：</p>
<p><strong>表1 TONUSDT永续合约规格详情</strong></p>
<table>
<thead>
<tr>
<th>合约要素</th>
<th>详细信息</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>合约标的</td>
<td>TON/USDT</td>
<td>以TON为标的资产，USDT为计价货币</td>
</tr>
<tr>
<td>结算货币</td>
<td>USDT</td>
<td>盈亏和保证金均以USDT结算</td>
</tr>
<tr>
<td>合约面值</td>
<td>1 TON</td>
<td>每张合约代表1个TON</td>
</tr>
<tr>
<td>价格精度</td>
<td>0.001</td>
<td>最小价格变动单位为0.001 USDT</td>
</tr>
<tr>
<td>杠杆倍数</td>
<td>0.01~20.00</td>
<td>支持1%至20倍杠杆</td>
</tr>
<tr>
<td>资金费率结算时间</td>
<td>每天 00:00、08:00、16:00 (UTC+8)</td>
<td>一天三次结算</td>
</tr>
<tr>
<td>标记价格</td>
<td>₮2.978</td>
<td>用于计算未实现盈亏的基准价格</td>
</tr>
<tr>
<td>持仓量</td>
<td>666.73万 TON</td>
<td>市场未平仓合约总量</td>
</tr>
<tr>
<td>24小时成交量</td>
<td>1,028.67万 TON</td>
<td>近24小时交易量</td>
</tr>
<tr>
<td>风险准备金</td>
<td>3,101,765 USDT</td>
<td>用于承担超额损失的保障资金</td>
</tr>
</tbody>
</table>
<blockquote>
<p><strong>风险准备金</strong>：由交易所维护的资金池，用于吸收强制平仓产生的损失。当用户爆仓时产生的亏损超过其保证金时，风险准备金会承担这部分损失，保护平台和其他用户免受影响。风险准备金主要来源于交易手续费和强制平仓的盈余。</p>
<p><strong>什么情况下会亏损超过保证金</strong>：在极端市场波动中，价格可能瞬间跳空或流动性不足，导致强制平仓时的成交价格远低于预期的强平价。例如，用户持有100倍杠杆的多仓，市场突然暴跌，系统来不及在理论强平价位平仓，实际平仓价格可能使亏损超过用户的全部保证金，这时风险准备金就会介入承担超额损失。</p>
</blockquote>
<h4 id="4-1-2-永续合约收益与费用计算">4.1.2 永续合约收益与费用计算</h4>
<h5 id="4-1-2-1-USDT本位永续合约收益计算（官方公式）">4.1.2.1 USDT本位永续合约收益计算（官方公式）</h5>
<p>根据OKX官方文档，USDT本位永续合约的收益计算公式为：</p>
<p><strong>基础收益计算</strong>：</p>
<ul>
<li><strong>多仓收益</strong> = 面值 × |张数| × 合约乘数 × (标记价格 - 开仓均价)</li>
<li><strong>空仓收益</strong> = 面值 × |张数| × 合约乘数 × (开仓均价 - 标记价格)</li>
</ul>
<h5 id="4-1-2-2-以TONUSDT永续合约为例">4.1.2.2 以TONUSDT永续合约为例</h5>
<ul>
<li>合约面值：1 TON</li>
<li>合约乘数：1</li>
<li>假设用户开多1000张，开仓均价2.500 USDT，当前标记价格2.800 USDT</li>
</ul>
<p><strong>收益计算</strong>：<br>
多仓收益 = 1 × 1000 × 1 × (2.800 - 2.500) = 300 USDT</p>
<h5 id="4-1-2-3-资金费用计算">4.1.2.3 资金费用计算</h5>
<p><strong>资金费用 = 持仓仓位价值 × 资金费率</strong></p>
<p>其中：持仓仓位价值 = 合约张数 × 合约面值 × 合约乘数 × 标记价格</p>
<p><strong>示例</strong>：</p>
<ul>
<li>持仓1000张TONUSDT，标记价格2.800 USDT，资金费率0.01%</li>
<li>持仓仓位价值 = 1000 × 1 × 1 × 2.800 = 2,800 USDT</li>
<li>资金费用 = 2,800 × 0.01% = 0.28 USDT</li>
</ul>
<h5 id="4-1-2-4-实际净收益">4.1.2.4 实际净收益</h5>
<p><strong>实际净收益 = 基础收益 - 开仓手续费 - 平仓手续费 ± 资金费用</strong></p>
<blockquote>
<p><strong>注意</strong>：资金费用可能为正（需支付）或负（可收取），取决于资金费率的方向和持仓方向。</p>
</blockquote>
<h3 id="4-2-杠杆与保证金制度">4.2 杠杆与保证金制度</h3>
<h4 id="4-2-1-杠杆倍数规则">4.2.1 杠杆倍数规则</h4>
<ul>
<li><strong>最高杠杆</strong>：支持高达125倍杠杆（具体倍数因交易对而异）</li>
<li><strong>动态调整</strong>：根据持仓规模实行阶梯式杠杆，持仓越大可用杠杆越低</li>
<li><strong>风险控制</strong>：大额持仓需要更高的维持保证金要求</li>
</ul>
<h4 id="4-2-2-保证金模式">4.2.2 保证金模式</h4>
<h5 id="4-2-2-1-全仓保证金模式">4.2.2.1 全仓保证金模式</h5>
<ul>
<li><strong>共享机制</strong>：所有持仓共享账户余额作为保证金</li>
<li><strong>风险分散</strong>：有助于避免单个持仓的强制平仓</li>
<li><strong>资金利用率</strong>：提高资金使用效率</li>
</ul>
<p><strong>全仓保证金计算示例</strong>：<br>
假设用户账户中有1,000 USDT，使用10倍杠杆开多1 BTC的BTCUSDT永续合约，当前BTC价格为50,000 USDT：</p>
<ul>
<li>合约张数 = 1 / 0.01 = 100张</li>
<li>初始保证金 = 0.01 × 100 × 50,000 / 10 = 5,000 USDT</li>
<li>由于账户只有1,000 USDT，无法开仓，需要至少5,000 USDT</li>
</ul>
<h5 id="4-2-2-2-逐仓保证金模式">4.2.2.2 逐仓保证金模式</h5>
<ul>
<li><strong>独立保证金</strong>：每个持仓使用独立的保证金</li>
<li><strong>风险隔离</strong>：将风险限制在单个持仓范围内</li>
<li><strong>损失控制</strong>：最大损失限制为该持仓的初始保证金</li>
</ul>
<p><strong>逐仓保证金计算示例</strong>：<br>
用户使用逐仓模式，投入500 USDT作为保证金，10倍杠杆开多TONUSDT永续合约，当前TON价格为2.5 USDT：</p>
<ul>
<li>可开仓位价值 = 500 × 10 = 5,000 USDT</li>
<li>可开合约张数 = 5,000 / 2.5 = 2,000张TON</li>
<li>预估强平价 = 开仓价格 × (1 - 1/杠杆 + 维持保证金率)</li>
<li>如果TON价格从2.5跌至约2.25左右将触发强制平仓</li>
<li>最大损失限制为投入的500 USDT保证金</li>
</ul>
<h4 id="4-2-3-保证金计算公式">4.2.3 保证金计算公式</h4>
<p><strong>USDT本位合约保证金公式</strong>：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">初始保证金 = (保证金余额 + 未实现盈亏) / (合约面值 × |合约张数| × 标记价格 × (维持保证金率 + 交易手续费率))</span><br></pre></td></tr></tbody></table></figure>
<p><strong>阶梯式维持保证金</strong>：</p>
<ul>
<li>持仓规模越大，维持保证金要求越高</li>
<li>降低最大可用杠杆，提升持仓稳定性</li>
<li>当保证金低于维持保证金加交易费用时，将触发强制平仓</li>
</ul>
<h2 id="5-风险管理机制与安全保障">5. 风险管理机制与安全保障</h2>
<p>本章节是永续合约技术体系的核心部分，将系统性阐述强制平仓机制、自动减仓机制等风险管理工具的原理和操作方式。通过深入分析这些机制如何保护交易者、交易所和整个市场的安全稳定，帮助读者建立对风险管理的全面认知。</p>
<h3 id="5-1-强制平仓机制详解">5.1 强制平仓机制详解</h3>
<h4 id="5-1-1-强制平仓机制核心要素">5.1.1 强制平仓机制核心要素</h4>
<p><strong>图7 强制平仓机制执行流程</strong></p>
<pre class="mermaid">flowchart TD
    A["用户持仓"] --&gt; B["实时监控<br>维持保证金率"]
    B --&gt; C{"维持保证金率 ≤ 100%?"}
    C --&gt;|否| B
    C --&gt;|是| D["触发强制平仓"]

    D --&gt; E["取消挂单<br>接管仓位"]
    E --&gt; F["市价单执行"]
    F --&gt; G["收取费用"]

    subgraph "费用结构"
        G1["强平手续费<br>（按吃单费率）"]
        G2["强平清算费<br>（按维持保证金率）"]
    end

    G --&gt; G1
    G --&gt; G2

    F --&gt; H{"风险准备金足够?"}
    H --&gt;|是| I["风险准备金承担价差损失<br>平仓完成"]
    H --&gt;|否| J["触发ADL机制<br>其他用户承担"]

    subgraph "核心公式"
        K["维持保证金率 = 调整后权益 / 维持保证金要求"]
        L["调整后权益 = 保证金余额 + 未实现盈亏"]
        M["维持保证金要求 = 合约张数 × 标记价格 × 梯度维持保证金率"]
    end

    style A fill:#f9f9f9
    style D fill:#ffcdd2
    style I fill:#c8e6c9
    style J fill:#ffeb3b
    style K fill:#e1f5fe
    style L fill:#e1f5fe
    style M fill:#e1f5fe</pre>
<p>如图7所示，强制平仓机制通过实时监控维持保证金率，当触发条件满足时自动执行平仓流程。该机制分为正常清算和ADL清算两种情况，确保系统风险的有效控制。</p>
<h5 id="5-1-1-1-核心概念定义">5.1.1.1 核心概念定义</h5>
<p><strong>强制平仓定义</strong>：<br>
当用户账户的维持保证金率降至100%时，系统自动处理风险仓位的过程。</p>
<p><strong>触发条件</strong>：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">维持保证金率 = 调整后权益 / 维持保证金要求 ≤ 100%</span><br></pre></td></tr></tbody></table></figure>
<blockquote>
<p><strong>注意</strong>：实际系统中的维持保证金率计算更加复杂，需要考虑挂单占用、期权保证金、逐仓占用等多种因素。上述公式为简化版本，便于理解核心原理。完整公式会包含:</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">维持保证金率 = (币种全仓内余额 + 全仓收益 - 挂单卖出数量 - 期权买单占用 - 逐仓开仓占用 - 挂单手续费) / (维持保证金 + 爆仓手续费)</span><br></pre></td></tr></tbody></table></figure>
</blockquote>
<p><strong>核心概念区别</strong>：</p>
<p><strong>1. 调整后权益</strong></p>
<ul>
<li><strong>定义</strong>：用户实际拥有的支撑持仓的价值</li>
<li><strong>计算</strong>：保证金余额 + 未实现盈亏</li>
<li><strong>作用</strong>：判断强制平仓的分子</li>
</ul>
<p><strong>2. 维持保证金要求</strong></p>
<ul>
<li><strong>定义</strong>：维持仓位不被强制平仓的最低资金要求</li>
<li><strong>基础计算</strong>：合约面值 × 合约张数 × 标记价格 × 梯度维持保证金率</li>
<li><strong>完整计算</strong>：还需加上爆仓手续费预估</li>
<li><strong>作用</strong>：判断强制平仓的分母，同时决定强平清算费的计算基础</li>
</ul>
<p><strong>3. 开仓保证金（初始保证金）</strong></p>
<ul>
<li><strong>定义</strong>：开仓时需要投入的资金</li>
<li><strong>计算</strong>：仓位价值 ÷ 杠杆倍数</li>
<li><strong>示例</strong>：10倍杠杆开1000张BTCUSDT，开仓保证金5,000 USDT</li>
</ul>
<p><strong>4. 维持保证金vs开仓保证金的关键差异</strong></p>
<ul>
<li><strong>数值大小</strong>：维持保证金 &lt;&lt; 开仓保证金（通常小100-200倍）</li>
<li><strong>用途</strong>：开仓保证金用于开仓，维持保证金用于判断强制平仓</li>
<li><strong>变化性</strong>：开仓保证金固定，维持保证金随标记价格变化</li>
</ul>
<p><strong>5. 梯度维持保证金率</strong></p>
<ul>
<li><strong>定义</strong>：根据持仓规模划分档位的风险系数</li>
<li><strong>原理</strong>：持仓越大，维持保证金率越高</li>
<li><strong>作用</strong>：既是强制平仓的判断标准，也是强平清算费的计算基础</li>
</ul>
<h5 id="5-1-1-2-梯度维持保证金率制度">5.1.1.2 梯度维持保证金率制度</h5>
<p><strong>基本原理</strong>：<br>
根据持仓规模划分档位，持仓越大，维持保证金率越高，最大可用杠杆越低。</p>
<p><strong>图6 梯度维持保证金率制度</strong></p>
<pre class="mermaid">graph TD
    subgraph "梯度维持保证金率制度"
        A["档位1<br>0-999张<br>保证金率: 0.4%<br>最大杠杆: 125倍"]
        B["档位2<br>1000-4999张<br>保证金率: 0.5%<br>最大杠杆: 100倍"]
        C["档位3<br>5000-9999张<br>保证金率: 1.0%<br>最大杠杆: 50倍"]
        D["档位4<br>10000-19999张<br>保证金率: 2.5%<br>最大杠杆: 20倍"]
        E["档位5<br>20000张以上<br>保证金率: 5.0%<br>最大杠杆: 10倍"]

        F["持仓规模增加"] --&gt; G["保证金率提高"]
        G --&gt; H["最大杠杆降低"]
        H --&gt; I["风险控制加强"]
    end

    A --&gt; B --&gt; C --&gt; D --&gt; E

    style A fill:#c8e6c9
    style B fill:#e8f5e8
    style C fill:#fff3e0
    style D fill:#ffecb3
    style E fill:#ffcdd2
    style F fill:#e1f5fe
    style G fill:#e1f5fe
    style H fill:#e1f5fe
    style I fill:#e1f5fe</pre>
<p>如图6所示，梯度维持保证金率制度通过档位划分，实现了风险与仓位规模的精确匹配。持仓规模越大，所需维持保证金率越高，可用杠杆越低，形成有效的风险控制机制。</p>
<table>
<thead>
<tr>
<th>档位</th>
<th>持仓规模</th>
<th>维持保证金率</th>
<th>最大杠杆</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>0-999张</td>
<td>0.4%</td>
<td>125倍</td>
</tr>
<tr>
<td>2</td>
<td>1000-4999张</td>
<td>0.5%</td>
<td>100倍</td>
</tr>
<tr>
<td>3</td>
<td>5000-9999张</td>
<td>1.0%</td>
<td>50倍</td>
</tr>
<tr>
<td>4</td>
<td>10000-19999张</td>
<td>2.5%</td>
<td>20倍</td>
</tr>
<tr>
<td>5</td>
<td>20000张以上</td>
<td>5.0%</td>
<td>10倍</td>
</tr>
</tbody>
</table>
<p><strong>作用机制</strong>：</p>
<ul>
<li><strong>风险递增控制</strong>：大仓位对市场冲击更大，需要更高保证金率</li>
<li><strong>流动性保护</strong>：防止大额仓位一次性平仓对市场造成冲击</li>
<li><strong>系统稳定性</strong>：降低单个大户爆仓对整个系统的影响</li>
</ul>
<h5 id="5-1-1-3-触发条件与判断流程">5.1.1.3 触发条件与判断流程</h5>
<p><strong>判断标准</strong>：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">维持保证金率 = 调整后权益 / 维持保证金要求 ≤ 100%</span><br></pre></td></tr></tbody></table></figure>
<p><strong>监控流程</strong>：</p>
<pre class="mermaid">graph TD
    A["实时监控"] --&gt; B["价格变化触发重算"]
    B --&gt; C{"维持保证金率 ≤ 100%?"}
    C --&gt;|否| D["继续监控"]
    C --&gt;|是| E["启动强平流程"]
    E --&gt; F["风控撤单<br>（撤销增加风险的挂单）"]
    F --&gt; G["预减仓撤单<br>（撤销所有挂单）"]
    G --&gt; H{"维持保证金率 &gt; 100%?"}
    H --&gt;|是| I["风险缓解，恢复正常"]
    H --&gt;|否| J["执行强制平仓"]
    J --&gt; K["按阶段减仓"]
    K --&gt; L["计算强平费用"]
    D --&gt; A
    I --&gt; A</pre>
<p><strong>详细执行步骤</strong>：</p>
<p><strong>第一阶段：风控撤单</strong> (维持保证金率 &lt; 300%)</p>
<ul>
<li>系统自动撤销增加仓位风险的挂单</li>
<li>包括：全仓开仓单、逐仓开仓单、卖出该币种的挂单</li>
<li>目的：通过减少潜在风险来避免强制平仓</li>
</ul>
<p><strong>第二阶段：预减仓撤单</strong> (维持保证金率 ≤ 100%)</p>
<ul>
<li>撤销该币种下所有未成交挂单（包含策略委托单）</li>
<li>撤销普通挂单的逐仓开仓单</li>
<li>撤销开仓属性的逐仓止盈止损单</li>
<li>保留平仓属性的止盈止损单</li>
</ul>
<p><strong>第三阶段：强制平仓执行</strong> (撤单后仍 ≤ 100%)</p>
<ul>
<li>按照官方文档规定的三个阶段顺序减仓：
<ol>
<li>优先减仓双向持仓下的反向仓位</li>
<li>减仓delta对冲的仓位（保持总delta值不变）</li>
<li>减仓剩余非对冲仓位（优先减降低风险效果最好的仓位）</li>
</ol>
</li>
</ul>
<p><strong>监控要点</strong>：</p>
<ul>
<li><strong>实时监控</strong>：风险管理引擎持续计算账户保证金率</li>
<li><strong>预警机制</strong>：当保证金率接近100%时发出预警（通常300%时开始预警）</li>
<li><strong>触发判断</strong>：保证金率降至100%时，系统判定触发强制平仓</li>
</ul>
<p><strong>账户模式差异</strong>：</p>
<ul>
<li><strong>逐仓模式</strong>：每个仓位单独计算维持保证金要求</li>
<li><strong>全仓模式</strong>：所有仓位综合计算维持保证金要求</li>
<li><strong>组合保证金模式</strong>：基于极端压力测试场景的亏损值确定</li>
</ul>
<p><strong>触发后的立即行动</strong>：</p>
<ol>
<li><strong>订单管理</strong>：自动取消或拒绝需要追加保证金的新订单</li>
<li><strong>仓位接管</strong>：交易所接管用户账户仓位的处理责任</li>
<li><strong>启动平仓</strong>：优先平仓保证金最高的仓位</li>
</ol>
<h5 id="5-1-1-4-强制平仓执行机制">5.1.1.4 强制平仓执行机制</h5>
<p><strong>执行流程</strong>：</p>
<ol>
<li>
<p><strong>部分平仓</strong>：</p>
<ul>
<li>系统尝试通过部分平仓使保证金率回升至安全水平</li>
<li>选择风险最高的仓位进行平仓</li>
<li>优先平仓保证金最高的仓位</li>
</ul>
</li>
<li>
<p><strong>全部平仓</strong>：</p>
<ul>
<li>如果部分平仓无法解决问题，进行全部平仓</li>
<li>确保账户不出现负权益</li>
</ul>
</li>
</ol>
<p><strong>价格基准</strong>：</p>
<ul>
<li><strong>标记价格</strong>：作为强制平仓的触发和执行基准</li>
<li><strong>避免误平仓</strong>：防止因单笔异常交易导致的误平仓</li>
<li><strong>确保公平性</strong>：保证价格的公平性和稳定性</li>
</ul>
<p><strong>执行方式</strong>：</p>
<ol>
<li><strong>市价单执行</strong>：将用户仓位作为市价单放入订单簿</li>
<li><strong>市场匹配</strong>：由其他交易者在市场价格接单</li>
<li><strong>交易所接管</strong>：交易所承担用户仓位的处理责任并使用风险准备金</li>
</ol>
<h5 id="5-1-1-5-费用结构">5.1.1.5 费用结构</h5>
<p><strong>图8 强制平仓费用结构体系</strong></p>
<pre class="mermaid">graph TD
    A["强制平仓费用"] --&gt; B["强制平仓手续费<br>（处理费用）"]
    A --&gt; C["强制平仓清算费<br>（风险补偿费用）"]

    B --&gt; D["计算公式:<br>手续费率 × (成交张数 × 合约乘数 × 合约面值 × 成交价格)"]
    B --&gt; E["费率规则:<br>按用户等级的吃单费率收取"]
    B --&gt; F["费率范围:<br>VIP0: 0.05% ~ VIP9: 0.01%"]

    C --&gt; G["计算公式:<br>合约面值 × 合约乘数 × 爆仓张数 × 标记价格 × 梯度维持保证金率"]
    C --&gt; H["特点:<br>公式与维持保证金要求相同"]
    C --&gt; I["作用:<br>让用户承担风险匹配的成本"]

    B --&gt; J["风险准备金账户"]
    C --&gt; J

    style A fill:#f3e5f5
    style B fill:#e1f5fe
    style C fill:#fff3e0
    style J fill:#c8e6c9</pre>
<p>如图8所示，强制平仓费用分为手续费和清算费两个组成部分。手续费补偿处理成本，清算费用于风险补偿，两种费用最终都进入风险准备金，增强系统安全性。</p>
<p><strong>费用类型</strong>：<br>
强制平仓时，用户需要支付两种专门的费用，<strong>不收取普通的开仓/平仓手续费</strong>：</p>
<p><strong>1. 强制平仓手续费（处理费用）</strong></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">强平手续费 = 强平手续费率 × (成交张数 × 合约乘数 × 合约面值 × 成交价格)</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><strong>费率规则</strong>：按照用户当前所处等级的<strong>吃单费率</strong>收取</li>
<li><strong>费率范围</strong>：VIP0为0.05%，VIP9为0.01%</li>
<li><strong>收取时机</strong>：强制平仓实际成交时收取</li>
<li><strong>结算货币</strong>：USDT永续合约手续费以USDT结算</li>
<li><strong>作用</strong>：补偿交易所处理强平订单的运营成本</li>
</ul>
<p><strong>2. 强制平仓清算费（风险补偿费用）</strong></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">U本位合约强平清算费 = 合约面值 × 合约乘数 × 爆仓张数 × 标记价格 × 梯度维持保证金率</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li><strong>重要特点</strong>：公式与维持保证金要求完全相同</li>
<li><strong>设计逻辑</strong>：让用户承担与其风险水平相匹配的成本</li>
<li><strong>作用</strong>：补偿价格差异风险，减轻风险准备金压力</li>
</ul>
<p><strong>费用计算示例</strong>：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">仓位：1000张BTCUSDT永续合约</span><br><span class="line">合约面值：0.01 BTC，合约乘数：1</span><br><span class="line">实际成交价格：49,500 USDT，标记价格：50,000 USDT</span><br><span class="line">用户等级：VIP1（吃单费率0.05%）</span><br><span class="line">梯度维持保证金率：0.4%</span><br><span class="line"></span><br><span class="line">强平手续费 = 0.05% × (1000 × 1 × 0.01 × 49,500) = 247.5 USDT</span><br><span class="line">强平清算费 = 0.01 × 1000 × 1 × 50,000 × 0.4% = 200 USDT</span><br><span class="line">总费用 = 447.5 USDT</span><br></pre></td></tr></tbody></table></figure>
<p><strong>资金流向</strong>：</p>
<ul>
<li>两种费用的净收益100%进入风险准备金账户</li>
<li>为用户提供额外保障，持续补充风险准备金</li>
</ul>
<h5 id="5-1-1-6-价格差异风险管理">5.1.1.6 价格差异风险管理</h5>
<p><strong>核心问题</strong>：<br>
强制平仓时，标记价格（触发价格）与实际成交价格的差异可能导致超额损失。</p>
<p><strong>价格差异原因</strong>：</p>
<ul>
<li><strong>标记价格</strong>：用于触发强制平仓的基准价格，相对稳定</li>
<li><strong>实际成交价格</strong>：在订单簿中实际成交的价格，受流动性影响</li>
<li><strong>差异产生</strong>：市场波动剧烈时，两者可能存在显著差异</li>
</ul>
<p><strong>风险影响</strong>：</p>
<ul>
<li><strong>用户风险</strong>：实际损失比按标记价格计算的损失更大，可能导致负权益</li>
<li><strong>交易所风险</strong>：需要通过风险准备金承担超额损失</li>
<li><strong>系统风险</strong>：大量用户同时爆仓时，累积的价格差异损失巨大</li>
</ul>
<p><strong>影响因素</strong>：</p>
<ul>
<li><strong>市场深度</strong>：流动性越差，价格差异越大</li>
<li><strong>波动性</strong>：价格波动越剧烈，差异越明显</li>
<li><strong>仓位规模</strong>：大仓位需要消耗更多订单簿深度</li>
</ul>
<p><strong>风险管理机制</strong>：</p>
<ul>
<li><strong>风险准备金</strong>：吸收价格差异产生的超额损失</li>
<li><strong>ADL机制</strong>：当风险准备金不足时，由其他用户承担</li>
<li><strong>强平清算费</strong>：让用户承担部分价格差异风险，减轻风险准备金压力</li>
</ul>
<h4 id="5-1-2-自动减仓机制（ADL）">5.1.2 自动减仓机制（ADL）</h4>
<p><strong>图9 自动减仓机制（ADL）执行流程</strong></p>
<pre class="mermaid">flowchart TD
    A["强制平仓发生"] --&gt; B["风险准备金评估"]
    B --&gt; C{"风险准备金充足?"}
    C --&gt;|是| D["正常清算完成<br>风险准备金承担损失"]
    C --&gt;|否| E["触发ADL机制"]

    E --&gt; F["识别相反方向仓位"]
    F --&gt; G["按ADL队列排序"]

    subgraph "ADL排序规则"
        H["盈利水平<br>（未实现盈利）"]
        I["杠杆倍数<br>（风险程度）"]
        J["综合评分<br>（盈利×杠杆）"]
    end

    G --&gt; H
    G --&gt; I
    G --&gt; J

    J --&gt; K["强制平仓高评分仓位"]
    K --&gt; L["平仓价格 = 破产价格<br>（对被ADL用户有利）"]
    L --&gt; M["损失由被ADL用户承担<br>保护风险准备金"]

    subgraph "风险管理层级"
        N1["第一层: 风险准备金"]
        N2["第二层: ADL机制"]
        N3["第三层: 交易所注资"]
    end

    style D fill:#c8e6c9
    style E fill:#ffeb3b
    style M fill:#ffcdd2
    style N1 fill:#e1f5fe
    style N2 fill:#fff3e0
    style N3 fill:#f3e5f5</pre>
<p>如图9所示，ADL机制是风险管理的第二道防线。当风险准备金不足时，系统会按照盈利水平和杠杆倍数对仓位进行排序，强制平仓高风险盈利仓位，形成三层风险管理体系。</p>
<h5 id="5-1-2-1-机制定义与作用">5.1.2.1 机制定义与作用</h5>
<p>自动减仓（Auto-Deleveraging，ADL）是一种风险管理机制，用于保护OKX风险准备金。当风险准备金无法吸收因清算亏损仓位而产生的进一步损失时，系统将启动ADL机制，将亏损仓位与相反的盈利或高杠杆仓位进行匹配平仓。</p>
<h5 id="5-1-2-2-清算与ADL流程图解">5.1.2.2 清算与ADL流程图解</h5>
<p><strong>正常清算流程（大多数情况）</strong>：</p>
<pre class="mermaid">graph TD
    A[用户保证金率低于维持保证金率] --&gt; B[系统触发强制平仓]
    B --&gt; C[将仓位作为市价单放入订单簿]
    C --&gt; D[其他交易者接单]
    D --&gt; E[平仓完成]
    E --&gt; F[风险准备金吸收小额损失]
    F --&gt; G[无需ADL]

    style A fill:#ffcccc
    style G fill:#ccffcc</pre>
<p><strong>ADL清算流程（特殊情况）</strong>：</p>
<pre class="mermaid">graph TD
    A[用户保证金率低于维持保证金率] --&gt; B[系统触发强制平仓]
    B --&gt; C[将仓位作为市价单放入订单簿]
    C --&gt; D{订单簿深度是否足够？}
    D --&gt;|是| E[其他交易者接单]
    D --&gt;|否| F[市价单部分成交或完全失败]
    F --&gt; G[风险准备金无法承担损失]
    G --&gt; H[触发ADL机制]
    H --&gt; I[寻找相反方向的盈利仓位]
    I --&gt; J[强制匹配平仓]
    J --&gt; K[ADL完成]

    E --&gt; L[平仓完成]
    L --&gt; M[风险准备金吸收小额损失]
    M --&gt; N[无需ADL]

    style A fill:#ffcccc
    style F fill:#ffaaaa
    style K fill:#ffffaa
    style N fill:#ccffcc</pre>
<p><strong>重要澄清：ADL针对的是盈利仓位，不是亏损仓位</strong></p>
<p>很多人误解ADL会影响有清算风险的仓位，实际上恰恰相反：</p>
<ul>
<li><strong>被ADL的仓位</strong>：健康的盈利仓位（被强制平仓）</li>
<li><strong>触发ADL的仓位</strong>：已经爆仓的亏损仓位（需要被清算）</li>
<li><strong>ADL的本质</strong>：用盈利仓位的利润来承担爆仓仓位的超额损失</li>
</ul>
<p><strong>基本原理</strong>：</p>
<ul>
<li>亏损仓位与盈利仓位（“被减仓位”）直接匹配</li>
<li>两个仓位相互抵消并平仓</li>
<li>消除亏损仓位对风险准备金的进一步威胁</li>
<li>盈利仓位被强制平仓，限制未来盈利潜力</li>
</ul>
<p><strong>ADL匹配机制详解</strong>：</p>
<p>系统会按照以下步骤进行仓位匹配：</p>
<p><strong>第1步：识别亏损仓位</strong></p>
<ul>
<li>系统扫描所有无法正常平仓的亏损仓位</li>
<li>这些仓位已经导致风险准备金损失或即将耗尽</li>
</ul>
<p><strong>第2步：寻找匹配的盈利仓位</strong></p>
<ul>
<li>在<strong>相反方向</strong>的仓位中寻找匹配对象</li>
<li>按照ADL排序规则确定被减仓的优先级</li>
<li>优先选择盈利最多、杠杆最高的仓位</li>
</ul>
<p><strong>第3步：数量匹配与平仓执行</strong></p>
<p><strong>匹配示例1：完全匹配</strong></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">亏损仓位：用户A持有BTCUSDT多仓 -100张（亏损状态）</span><br><span class="line">盈利仓位：用户B持有BTCUSDT空仓 +100张（盈利状态）</span><br><span class="line">匹配结果：两个仓位完全匹配，同时平仓</span><br><span class="line">执行价格：当前标记价格</span><br></pre></td></tr></tbody></table></figure>
<p><strong>匹配示例2：部分匹配（亏损仓位较大）</strong></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">亏损仓位：用户A持有BTCUSDT多仓 -500张（亏损状态）</span><br><span class="line">盈利仓位：用户B持有BTCUSDT空仓 +100张（盈利状态）</span><br><span class="line">匹配结果：</span><br><span class="line">- 用户B的100张空仓全部平仓</span><br><span class="line">- 用户A的500张多仓中，100张被平仓</span><br><span class="line">- 用户A剩余400张多仓需要寻找下一个匹配对象</span><br></pre></td></tr></tbody></table></figure>
<p><strong>匹配示例3：部分匹配（盈利仓位较大）</strong></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">亏损仓位：用户A持有BTCUSDT多仓 -80张（亏损状态）</span><br><span class="line">盈利仓位：用户B持有BTCUSDT空仓 +200张（盈利状态）</span><br><span class="line">匹配结果：</span><br><span class="line">- 用户A的80张多仓全部平仓</span><br><span class="line">- 用户B的200张空仓中，80张被平仓</span><br><span class="line">- 用户B剩余120张空仓继续持有</span><br></pre></td></tr></tbody></table></figure>
<p><strong>第4步：连续匹配处理</strong><br>
当单个盈利仓位无法完全匹配亏损仓位时，系统会：</p>
<ol>
<li>按ADL排序顺序寻找下一个盈利仓位</li>
<li>继续进行匹配，直至亏损仓位完全平仓</li>
<li>记录所有被减仓的用户和数量</li>
</ol>
<p><strong>实际案例：市场暴跌触发ADL</strong></p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">市场情况：BTC从50,000跌至40,000，多个高杠杆多仓爆仓</span><br><span class="line"></span><br><span class="line">步骤1：识别触发ADL的亏损仓位</span><br><span class="line">- 用户A：100倍杠杆多仓 -1000张（已爆仓，保证金耗尽）</span><br><span class="line">- 用户C：50倍杠杆多仓 -500张（已爆仓，保证金耗尽）</span><br><span class="line">- 用户E：25倍杠杆多仓 -300张（已爆仓，保证金耗尽）</span><br><span class="line">总计需要清算：1800张多仓</span><br><span class="line"></span><br><span class="line">步骤2：寻找被ADL的盈利仓位（相反方向的空仓）</span><br><span class="line">按ADL排序规则选择：</span><br><span class="line">1. 用户B：空仓 +600张（盈利20%，杠杆100倍）→ 全部被减仓</span><br><span class="line">2. 用户D：空仓 +400张（盈利15%，杠杆50倍）→ 全部被减仓</span><br><span class="line">3. 用户F：空仓 +800张（盈利10%，杠杆20倍）→ 其中800张被减仓</span><br><span class="line"></span><br><span class="line">步骤3：匹配结果</span><br><span class="line">- 亏损的1800张多仓全部平仓（这些用户已经爆仓）</span><br><span class="line">- 盈利的1800张空仓被强制平仓（这些用户原本在赚钱）</span><br><span class="line">- 匹配在标记价格42,000执行</span><br><span class="line"></span><br><span class="line">步骤4：资金流向</span><br><span class="line">- 用户B、D、F的利润被用来填补用户A、C、E的超额损失</span><br><span class="line">- 风险准备金得到保护，避免进一步损失</span><br></pre></td></tr></tbody></table></figure>
<p><strong>关键理解：谁受到ADL影响？</strong></p>
<p>❌ <strong>错误理解</strong>：有清算风险的仓位会被ADL<br>
✅ <strong>正确理解</strong>：盈利良好的仓位会被ADL</p>
<p><strong>具体说明</strong>：</p>
<ul>
<li><strong>有清算风险的仓位</strong>：这些仓位已经爆仓，保证金耗尽，无法继续交易</li>
<li><strong>被ADL的仓位</strong>：这些是健康的盈利仓位，本来可以继续持有，但被强制平仓</li>
<li><strong>ADL的不公平性</strong>：盈利的交易者被迫承担了爆仓者的损失</li>
<li><strong>ADL的必要性</strong>：保护交易所和其他用户免受系统性风险</li>
</ul>
<p><strong>重要问题：所有清算都需要ADL吗？</strong></p>
<p><strong>答案：不是！ADL只在特殊情况下触发</strong></p>
<p><strong>正常清算流程（大多数情况）</strong>：</p>
<ul>
<li>
<p>触发强制平仓<br>
用户保证金率低于维持保证金率 → 系统触发强制平仓</p>
</li>
<li>
<p>订单簿平仓<br>
系统将用户的仓位作为市价单放入订单簿 → 由其他交易者接单</p>
</li>
<li>
<p>风险准备金吸收<br>
如果有小额损失（平仓价格略差于预期）→ 风险准备金吸收损失</p>
</li>
</ul>
<p>结果：平仓完成，无需ADL</p>
<p><strong>关键问题：为什么市价单机制仍可能失败？</strong></p>
<p>理论上，市价单会以任何可用价格成交，但实际中存在以下问题：</p>
<p><strong>1. 订单簿深度不足</strong><br>
正常情况下的订单簿：<br>
买盘：</p>
<ul>
<li>49,950: 100张</li>
<li>49,900: 200张</li>
<li>49,850: 300张</li>
<li>49,800: 400张</li>
<li>49,750: 500张<br>
总深度：1,500张</li>
</ul>
<p>但某用户爆仓需要平仓2,000张多仓！<br>
结果：订单簿深度不足，无法完全消化</p>
<p><strong>2. 极端市场条件下的订单簿状态</strong><br>
市场恐慌时的订单簿：<br>
买盘：</p>
<ul>
<li>49,000: 10张 (价格跳空严重)</li>
<li>48,000: 20张</li>
<li>47,000: 30张</li>
<li>46,000: 40张</li>
<li>45,000: 50张</li>
</ul>
<p>问题：</p>
<ul>
<li>流动性极度匮乏</li>
<li>价格跳空巨大</li>
<li>接单者寥寥无几</li>
</ul>
<p><strong>3. 市价单的执行现实</strong><br>
爆仓用户：需要平仓1,000张BTCUSDT多仓<br>
当前标记价格：50,000 USDT<br>
订单簿状态：</p>
<ul>
<li>49,500: 100张</li>
<li>49,000: 200张</li>
<li>48,000: 300张</li>
<li>47,000: 400张 (深度不足)</li>
</ul>
<p>执行结果：</p>
<ul>
<li>前700张可以在49,500-47,000之间成交</li>
<li>剩余300张找不到买家</li>
<li>或者价格跌至极低（如45,000）才有买家</li>
</ul>
<p><strong>4. 为什么会出现这种情况？</strong></p>
<p><strong>市场恐慌效应</strong>：</p>
<ul>
<li>当价格暴跌时，买家会撤单或降低报价</li>
<li>大家都在抛售，很少有人愿意接盘</li>
<li>流动性提供者（做市商）也会减少报价或退出</li>
</ul>
<p><strong>技术限制</strong>：</p>
<ul>
<li>订单簿更新需要时间</li>
<li>大额单子瞬间消耗完所有流动性</li>
<li>系统无法瞬间创造新的买家</li>
</ul>
<p><strong>心理因素</strong>：</p>
<ul>
<li>看到大量强制平仓，其他交易者也会恐慌</li>
<li>预期价格继续下跌，不愿意高价接盘</li>
<li>流动性螺旋：流动性越少，价格波动越大，流动性进一步减少</li>
</ul>
<p><strong>5. 流动性螺旋与连环爆仓</strong></p>
<p>这是加密货币市场最危险的现象之一——<strong>正反馈循环</strong>：</p>
<p><strong>螺旋清算流程图</strong>：</p>
<pre class="mermaid">graph TD
    A[价格开始波动] --&gt; B{波动方向}
    B --&gt;|下跌| C[多仓开始爆仓]
    B --&gt;|上涨| D[空仓开始爆仓]

    C --&gt; E[大量卖单涌入]
    E --&gt; F[空仓用户不愿接盘]
    F --&gt; G[价格进一步下跌]
    G --&gt; H[更多多仓爆仓]
    H --&gt; I[恐慌性抛售]
    I --&gt; J[价格瀑布式下跌]
    J --&gt; K[连环爆仓完成]

    D --&gt; L[大量买单涌入]
    L --&gt; M[多仓用户不愿卖出]
    M --&gt; N[价格进一步上涨]
    N --&gt; O[更多空仓爆仓]
    O --&gt; P[恐慌性买入]
    P --&gt; Q[价格火箭式上涨]
    Q --&gt; R[连环爆仓完成]

    style A fill:#e1f5fe
    style J fill:#ffcdd2
    style Q fill:#ffcdd2
    style K fill:#ffeb3b
    style R fill:#ffeb3b</pre>
<p><strong>下跌螺旋（多仓连环爆仓）</strong>：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">第1步：价格开始下跌</span><br><span class="line">BTC从50,000跌至48,000</span><br><span class="line"></span><br><span class="line">第2步：高杠杆多仓开始爆仓</span><br><span class="line">- 100倍杠杆用户首先爆仓</span><br><span class="line">- 系统强制卖出大量BTC合约</span><br><span class="line">- 需要空仓用户接单</span><br><span class="line"></span><br><span class="line">第3步：卖压增加，价格进一步下跌</span><br><span class="line">- 大量卖单涌入市场</span><br><span class="line">- 空仓用户看到跌势，不愿意高价接盘</span><br><span class="line">- 价格继续跌至46,000</span><br><span class="line"></span><br><span class="line">第4步：更多多仓爆仓</span><br><span class="line">- 50倍杠杆用户开始爆仓</span><br><span class="line">- 更多强制卖单进入市场</span><br><span class="line">- 价格加速下跌至44,000</span><br><span class="line"></span><br><span class="line">第5步：恐慌性抛售</span><br><span class="line">- 其他交易者看到连环爆仓，主动平仓</span><br><span class="line">- 价格瀑布式下跌</span><br><span class="line">- 最终可能跌至35,000-40,000</span><br></pre></td></tr></tbody></table></figure>
<p><strong>上涨螺旋（空仓连环爆仓）</strong>：</p>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">第1步：价格开始上涨</span><br><span class="line">BTC从50,000涨至52,000</span><br><span class="line"></span><br><span class="line">第2步：高杠杆空仓开始爆仓</span><br><span class="line">- 100倍杠杆空仓用户首先爆仓</span><br><span class="line">- 系统强制买入大量BTC合约</span><br><span class="line">- 需要多仓用户卖出匹配</span><br><span class="line"></span><br><span class="line">第3步：买压增加，价格进一步上涨</span><br><span class="line">- 大量买单涌入市场</span><br><span class="line">- 多仓用户看到涨势，不愿意低价卖出</span><br><span class="line">- 价格继续涨至54,000</span><br><span class="line"></span><br><span class="line">第4步：更多空仓爆仓</span><br><span class="line">- 50倍杠杆空仓用户开始爆仓</span><br><span class="line">- 更多强制买单进入市场</span><br><span class="line">- 价格加速上涨至56,000</span><br><span class="line"></span><br><span class="line">第5步：恐慌性买入</span><br><span class="line">- 其他交易者看到连环爆仓，主动平空仓</span><br><span class="line">- 价格火箭式上涨</span><br><span class="line">- 最终可能涨至60,000-65,000</span><br></pre></td></tr></tbody></table></figure>
<p><strong>为什么会发生这种情况？</strong></p>
<p><strong>1. 杠杆的放大效应</strong>：</p>
<ul>
<li>高杠杆用户只需要小幅价格变动就会爆仓</li>
<li>爆仓时产生的买卖压力远大于正常交易</li>
</ul>
<p><strong>2. 流动性的不对称性</strong>：</p>
<ul>
<li>上涨时：多仓用户不愿意卖出（怕错过更大涨幅）</li>
<li>下跌时：空仓用户不愿意买入（怕接到下跌的刀子）</li>
</ul>
<p><strong>3. 恐慌与贪婪心理</strong>：</p>
<ul>
<li>看到连环爆仓，其他用户会恐慌或贪婪</li>
<li>加剧了市场的不理性行为</li>
</ul>
<p><strong>4. 算法交易的助推</strong>：</p>
<ul>
<li>程序化交易会识别爆仓模式</li>
<li>可能会故意触发连环爆仓来获利</li>
</ul>
<p><strong>历史案例</strong>：</p>
<ul>
<li><strong>2021年5月19日</strong>：BTC在几小时内从58,000跌至30,000</li>
<li><strong>2021年4月18日</strong>：BTC在短时间内从65,000跌至52,000</li>
<li><strong>各种"插针"事件</strong>：价格瞬间暴涨暴跌后快速回归</li>
</ul>
<p><strong>这就是为什么需要ADL的根本原因</strong>：</p>
<ul>
<li>在连环爆仓中，正常的订单簿匹配完全失效</li>
<li>价格可能偏离合理水平数十个百分点</li>
<li>风险准备金根本无法承担如此巨大的损失</li>
<li>必须通过ADL强制平仓盈利仓位来止损</li>
</ul>
<p><strong>需要ADL的特殊情况</strong>：</p>
<ul>
<li>
<p>正常强制平仓失败<br>
系统尝试在订单簿平仓 → 但市场流动性不足或价格跳空严重</p>
</li>
<li>
<p>产生超额损失<br>
平仓价格远差于预期 → 损失超过用户保证金 → 威胁风险准备金</p>
</li>
<li>
<p>风险准备金不足<br>
超额损失过大 → 风险准备金无法完全吸收 → 触发ADL机制</p>
</li>
<li>
<p>结果：启动ADL，强制平仓盈利仓位</p>
</li>
</ul>
<p><strong>具体示例：为什么会产生超额损失？</strong></p>
<p>用户情况：</p>
<ul>
<li>持有1,000张BTCUSDT多仓</li>
<li>开仓价格：50,000 USDT</li>
<li>保证金：10,000 USDT (20倍杠杆)</li>
<li>强制平仓触发价格：49,500 USDT</li>
</ul>
<p>正常情况下的期望：</p>
<ul>
<li>应该在49,500左右平仓</li>
<li>损失：1,000 × (50,000 - 49,500) = 500,000 USDT</li>
<li>超过保证金的损失：500,000 - 10,000 = 490,000 USDT</li>
<li>风险准备金承担：490,000 USDT</li>
</ul>
<p>但实际发生：</p>
<ul>
<li>市场流动性不足，价格跳空至45,000</li>
<li>实际平仓价格：45,000 USDT</li>
<li>实际损失：1,000 × (50,000 - 45,000) = 5,000,000 USDT</li>
<li>超过保证金的损失：5,000,000 - 10,000 = 4,990,000 USDT</li>
<li>风险准备金需要承担：4,990,000 USDT</li>
</ul>
<p>如果风险准备金只有2,000,000 USDT：</p>
<ul>
<li>风险准备金不足，触发ADL</li>
<li>需要找4,990,000 - 2,000,000 = 2,990,000 USDT</li>
<li>通过平仓盈利的空仓来获得这笔资金</li>
</ul>
<p><strong>ADL触发的具体条件</strong>：</p>
<ol>
<li><strong>风险准备金不足</strong>：当前风险准备金低于安全阈值</li>
<li><strong>市场极端波动</strong>：价格跳空或流动性危机</li>
<li><strong>大额爆仓</strong>：单笔或多笔爆仓损失过大</li>
<li><strong>连锁反应</strong>：多个用户同时爆仓，风险准备金快速消耗</li>
</ol>
<p><strong>实际比例</strong>：</p>
<ul>
<li><strong>正常情况</strong>：约95%的强制平仓通过订单簿完成，无需ADL</li>
<li><strong>特殊情况</strong>：约5%的极端情况需要ADL介入</li>
<li><strong>危机时期</strong>：在市场崩盘时，ADL使用频率会显著增加</li>
</ul>
<p><strong>ADL vs 正常清算对比</strong>：</p>
<table>
<thead>
<tr>
<th>对比项目</th>
<th>正常清算</th>
<th>ADL清算</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>触发条件</strong></td>
<td>保证金率不足</td>
<td>风险准备金不足</td>
</tr>
<tr>
<td><strong>执行方式</strong></td>
<td>订单簿匹配</td>
<td>强制仓位匹配</td>
</tr>
<tr>
<td><strong>价格确定</strong></td>
<td>市场价格</td>
<td>标记价格</td>
</tr>
<tr>
<td><strong>手续费</strong></td>
<td>正常收取</td>
<td>免收手续费</td>
</tr>
<tr>
<td><strong>影响对象</strong></td>
<td>爆仓用户</td>
<td>盈利用户</td>
</tr>
<tr>
<td><strong>频率</strong></td>
<td>常见</td>
<td>罕见</td>
</tr>
</tbody>
</table>
<p><strong>匹配原则</strong>：</p>
<ol>
<li><strong>方向相反</strong>：多仓亏损匹配空仓盈利，空仓亏损匹配多仓盈利</li>
<li><strong>数量对等</strong>：平仓数量必须相等，实现完全对冲</li>
<li><strong>价格统一</strong>：所有ADL匹配都在同一标记价格执行</li>
<li><strong>无手续费</strong>：ADL执行不收取交易手续费</li>
<li><strong>强制执行</strong>：被选中的盈利仓位无法拒绝，必须平仓</li>
</ol>
<h5 id="5-1-2-3-触发条件">5.1.2.3 触发条件</h5>
<p><strong>1. 波动跌幅阈值触发</strong>：<br>
当适用风险准备金的当前价值低于：</p>
<ul>
<li>过去8小时内风险准备金平均价值减去以下两项中的较大者：
<ul>
<li>8小时平均值的30%</li>
<li>50,000美元（或等值金额）</li>
</ul>
</li>
</ul>
<p><strong>实际案例</strong>：</p>
<ul>
<li>风险准备金当前价值：200,000美元</li>
<li>8小时平均值：400,000美元</li>
<li>30%为120,000美元（&gt;50,000美元，采用此标准）</li>
<li>波动跌幅阈值：400,000 - 120,000 = 280,000美元</li>
<li>由于200,000 &lt; 280,000，触发ADL</li>
</ul>
<p><strong>2. 其他触发条件</strong>：</p>
<ul>
<li>适用风险准备金已全部耗尽</li>
<li>盘前交易合约：未成交强平单超过特定数量和时间阈值</li>
</ul>
<h5 id="5-1-2-4-ADL排序规则与风险指示">5.1.2.4 ADL排序规则与风险指示</h5>
<p><strong>排序算法</strong>：</p>
<ul>
<li><strong>逐仓模式</strong>：盈利仓位 = 收益率 ÷ 保证金率；亏损仓位 = 收益率 × 保证金率</li>
<li><strong>全仓模式</strong>：使用账户保证金率而非仓位保证金率</li>
<li><strong>综合因素</strong>：考虑仓位盈利程度、亏损程度、杠杆使用量</li>
<li><strong>排名越高</strong>：在ADL中被选中的概率越大</li>
</ul>
<p><strong>风险指示灯系统</strong>：</p>
<ul>
<li>5格灯显示ADL风险等级</li>
<li>全部5格点亮：自动减仓风险最高</li>
<li>1格点亮：风险较低</li>
<li>在高度波动市场中，即使低风险仓位也可能面临ADL</li>
</ul>
<h5 id="5-1-2-5-执行机制">5.1.2.5 执行机制</h5>
<p><strong>正常清算 vs ADL执行</strong>：</p>
<ul>
<li><strong>正常清算</strong>：亏损仓位进入订单簿，由市场相反订单吸收</li>
<li><strong>ADL执行</strong>：亏损仓位直接与被减仓位匹配，无需进入订单簿</li>
</ul>
<p><strong>执行特点</strong>：</p>
<ul>
<li>以标记价格执行，不收取交易手续费</li>
<li>被减仓位立即锁定利润，无法获得进一步收益</li>
<li>关键风险：重新开仓价格可能与被减仓位不同</li>
</ul>
<h5 id="5-1-2-6-ADL终止条件">5.1.2.6 ADL终止条件</h5>
<p><strong>恢复条件</strong>：</p>
<ul>
<li>风险准备金价值增加超过波动跌幅阈值加上缓冲金额</li>
<li>缓冲金额为以下两项中的较大者：
<ul>
<li>触发ADL时8小时平均值的6%</li>
<li>10,000美元（或等值金额）</li>
</ul>
</li>
</ul>
<p><strong>终止案例</strong>：</p>
<ul>
<li>风险准备金价值增加至320,000美元</li>
<li>波动跌幅阈值：280,000美元</li>
<li>缓冲金额：400,000 × 6% = 24,000美元（&gt;10,000美元）</li>
<li>终止阈值：280,000 + 24,000 = 304,000美元</li>
<li>由于320,000 &gt; 304,000，ADL停止</li>
</ul>
<h5 id="5-1-2-7-预警与防范">5.1.2.7 预警与防范</h5>
<p><strong>预警系统</strong>：</p>
<ul>
<li>监控适用风险准备金余额变化</li>
<li>订阅自动减仓预警频道</li>
<li>风险准备金剧烈波动是ADL可能性增加的指标</li>
</ul>
<p><strong>防范措施</strong>：</p>
<ul>
<li>降低杠杆可减少ADL影响概率</li>
<li>监控5格风险指示灯状态</li>
<li>关注市场波动性，ADL最常发生在高波动市场</li>
</ul>
<h4 id="5-1-3-保险基金制度">5.1.3 保险基金制度</h4>
<h5 id="5-1-3-1-基金构成">5.1.3.1 基金构成</h5>
<ul>
<li>OKX官方提供的资金</li>
<li>强制平仓订单产生的盈余</li>
</ul>
<h5 id="5-1-3-2-独立运营">5.1.3.2 独立运营</h5>
<ul>
<li>不同业务线（现货杠杆、期货、永续合约、期权）的保险基金相互独立</li>
<li>同一业务线内，不同标的和币种的保险基金也相互分离</li>
</ul>
<h4 id="5-1-4-标记价格系统">5.1.4 标记价格系统</h4>
<ul>
<li><strong>作用</strong>：作为强制平仓和ADL执行的价格基准</li>
<li><strong>计算</strong>：基于多个现货交易所的加权平均价格</li>
<li><strong>防操纵</strong>：避免单一交易所价格异常对合约交易的影响</li>
</ul>
<h2 id="6-交易费用结构与定价机制">6. 交易费用结构与定价机制</h2>
<p>本章节详细介绍了OKX永续合约的费用结构和定价机制。通过分析不同类型费率的计算方式和分级标准，为交易者提供成本管理的参考依据。</p>
<h3 id="6-1-费用结构与级别制度">6.1 费用结构与级别制度</h3>
<h4 id="6-1-1-手续费分级制度">6.1.1 手续费分级制度</h4>
<p>根据用户的30天交易量和OKB持仓量实行阶梯费率制度。</p>
<h4 id="6-1-2-费率类型分类">6.1.2 费率类型分类</h4>
<ul>
<li><strong>挂单费率</strong>：通常享受费率优惠</li>
<li><strong>吃单费率</strong>：按标准费率收取</li>
<li><strong>强制平仓费用</strong>：
<ul>
<li>强制平仓手续费：替代普通交易手续费</li>
<li>强制平仓清算费：额外的风险补偿费用</li>
<li><strong>重要</strong>：强制平仓时不收取普通开仓/平仓手续费</li>
</ul>
</li>
</ul>
<h2 id="参考材料">参考材料</h2>
<ul>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.okx.com/zh-hans/help/i-spot-index-prices">指数计算规则</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.okx.com/zh-hans/help/i-perpetual-swaps">永续合约说明</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.okx.com/zh-hans/help/ii-mark-price-and-last-price">标记价格机制</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.okx.com/zh-hans/learn/understanding-mark-price">标记价格详解</a></li>
<li><a target="_blank" rel="noopener external nofollow noreferrer" href="https://www.okx.com/zh-hans/help/iv-introduction-to-perpetual-swap-funding-fee">资金费率介绍</a></li>
</ul>
<div class="mermaid-wrap"><pre class="mermaid-src" hidden="">    
  </pre></div>
<figure class="highlight plaintext"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"></span><br></pre></td></tr></tbody></table></figure>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta"><i class="fas fa-circle-user fa-fw"></i>Author: </span><span class="post-copyright-info"><a href="https://www.blog-blockchain.xyz">Michael(Jiahao) Luo</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta"><i class="fas fa-square-arrow-up-right fa-fw"></i>Link: </span><span class="post-copyright-info"><a href="https://www.blog-blockchain.xyz/finance/cex-perp/">https://www.blog-blockchain.xyz/finance/cex-perp/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta"><i class="fas fa-circle-exclamation fa-fw"></i>Copyright Notice: </span><span class="post-copyright-info">All articles on this blog are licensed under <a target="_blank" rel="noopener external nofollow noreferrer" href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> unless otherwise stated.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/perpetual-swap/">perpetual swap</a><a class="post-meta__tags" href="/tags/CEX/">CEX</a><a class="post-meta__tags" href="/tags/OKX/">OKX</a><a class="post-meta__tags" href="/tags/derivatives/">derivatives</a><a class="post-meta__tags" href="/tags/leverage/">leverage</a><a class="post-meta__tags" href="/tags/risk-management/">risk management</a><a class="post-meta__tags" href="/tags/funding-rate/">funding rate</a><a class="post-meta__tags" href="/tags/liquidation/">liquidation</a><a class="post-meta__tags" href="/tags/ADL/">ADL</a><a class="post-meta__tags" href="/tags/margin/">margin</a><a class="post-meta__tags" href="/tags/cryptocurrency/">cryptocurrency</a></div><div class="post-share"><div class="social-share" data-image="https://cdn.blog-blockchain.xyz/2025/07/74399f8c78200a815d4cd88c3e39c4a7.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/sharejs/dist/js/social-share.min.js" defer=""></script></div></div><nav class="pagination-post" id="pagination"><a class="pagination-related" href="/dev/hexo-cache-busting-solution/" title="Hexo博客缓存问题的终极解决方案"><img class="cover" src="https://cdn.blog-blockchain.xyz/2025/07/717868abde8ec43fd9ded6bb36280318.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="info"><div class="info-1"><div class="info-item-1">Previous</div><div class="info-item-2">Hexo博客缓存问题的终极解决方案</div></div><div class="info-2"><div class="info-item-1">深入分析Hexo博客部署后浏览器缓存导致内容不更新的根本原因，提供基于Hexo钩子系统的智能化缓存清理解决方案，实现自动版本控制和缓存管理，让用户无需手动清理即可看到最新内容。</div></div></div></a><a class="pagination-related" href="/finance/denationalization-of-money/" title="哈耶克《货币的非国家化》：思维的突破与论证的力量"><img class="cover" src="https://cdn.blog-blockchain.xyz/2025/07/c37e6300082fc0e3bde8a0ec953d958d.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="info text-right"><div class="info-1"><div class="info-item-1">Next</div><div class="info-item-2">哈耶克《货币的非国家化》：思维的突破与论证的力量</div></div><div class="info-2"><div class="info-item-1">本文通过深入分析哈耶克《货币的非国家化》的论证逻辑、历史依据和制度设计，展现了这一思想体系的内在逻辑和现代意义。哈耶克不仅是在提出一个激进的政策建议，更是在构建一套全新的货币理论框架，挑战我们对货币、政府和市场关系的基本认知。在数字货币蓬勃发展的今天，重新审视这一经典理论，不仅有助于理解当前金融变革的深层逻辑，更能为未来制度创新提供思想指引。</div></div></div></a></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>Related Articles</span></div><div class="relatedPosts-list"><a class="pagination-related" href="/finance/ftx-alameda-collapse-case-study/" title="320亿美元消失记：FTX帝国崩塌背后的人性贪婪与制度失效"><img class="cover" src="https://cdn.blog-blockchain.xyz/2025/07/449fc564e4e9aa38a6eaf425abc6ef44.png" alt="cover"><div class="info text-center"><div class="info-1"><div class="info-item-1"><i class="far fa-calendar-alt fa-fw"></i> 2025-07-27</div><div class="info-item-2">320亿美元消失记：FTX帝国崩塌背后的人性贪婪与制度失效</div></div><div class="info-2"><div class="info-item-1">本文通过深度分析FTX-Alameda连锁崩塌事件，系统性研究统一账户保证金交易的系统性风险机制，涵盖风险演化过程、传导机制、根本原因和监管失效等核心问题，为加密货币风险管理和金融监管提供重要案例参考。</div></div></div></a></div></div><hr class="custom-hr"><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> Comments</span></div></div><div class="comment-wrap"><div><div id="gitalk-container"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info text-center"><div class="avatar-img"><img src="/images/site-avator.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"></div><div class="author-info-name">Michael(Jiahao) Luo</div><div class="author-info-description"></div><div class="site-data"><a href="/archives/"><div class="headline">Articles</div><div class="length-num">98</div></a><a href="/tags/"><div class="headline">Tags</div><div class="length-num">63</div></a><a href="/categories/"><div class="headline">Categories</div><div class="length-num">30</div></a></div><a id="card-info-btn" target="_blank" rel="noopener external nofollow noreferrer" href="https://x.com/jiahao_luo9"><i class="fa-brands fa-twitter"></i><span>Follow Me</span></a><div class="card-info-social-icons"><a class="social-icon" href="https://www.linkedin.com/in/jiahao-michael-luo-8ba5942a3" rel="external nofollow noreferrer" target="_blank" title="Linkedin"><i class="fa-brands fa-linkedin"></i></a><a class="social-icon" href="https://x.com/jiahao_luo9" rel="external nofollow noreferrer" target="_blank" title="Twitter"><i class="fa-brands fa-twitter"></i></a><a class="social-icon" href="https://github.com/learnerLj" rel="external nofollow noreferrer" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:luoshitou9@gmail.com" rel="external nofollow noreferrer" target="_blank" title="Email"><i class="fas fa-envelope"></i></a><a class="social-icon" href="/atom.xml" target="_blank" title="RSS链接"><i class="fa fa-rss"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>Announcement</span></div><div class="announcement_content">从技术到商业，从产品到设计，从生活到未来，我会在这里分享我的所思所想，欢迎关注！</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>Contents</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A6%82%E8%BF%B0"><span class="toc-text">概述</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%9C%AF%E8%AF%AD%E5%AE%9A%E4%B9%89"><span class="toc-text">核心术语定义</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%B0%B8%E7%BB%AD%E5%90%88%E7%BA%A6%E5%9F%BA%E7%A1%80%E6%9E%B6%E6%9E%84"><span class="toc-text">1. 永续合约基础架构</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E6%B0%B8%E7%BB%AD%E5%90%88%E7%BA%A6%E7%B1%BB%E5%9E%8B%E4%B8%8E%E8%A7%84%E6%A0%BC"><span class="toc-text">1.1 永续合约类型与规格</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-1-%E5%90%88%E7%BA%A6%E7%B1%BB%E5%9E%8B%E5%88%86%E7%B1%BB"><span class="toc-text">1.1.1 合约类型分类</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-1-1-USDT%E6%9C%AC%E4%BD%8D%E6%B0%B8%E7%BB%AD%E5%90%88%E7%BA%A6%EF%BC%88%E4%B8%BB%E6%B5%81%EF%BC%89"><span class="toc-text">1.1.1.1 USDT本位永续合约（主流）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-1-2-%E5%B8%81%E6%9C%AC%E4%BD%8D%E6%B0%B8%E7%BB%AD%E5%90%88%E7%BA%A6%EF%BC%88%E8%BE%83%E5%B0%91%E4%BD%BF%E7%94%A8%EF%BC%89"><span class="toc-text">1.1.1.2 币本位永续合约（较少使用）</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-2-%E8%AE%A2%E5%8D%95%E7%B0%BF%E5%9F%BA%E7%A1%80%E6%9C%BA%E5%88%B6"><span class="toc-text">1.1.2 订单簿基础机制</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-2-1-%E8%AE%A2%E5%8D%95%E7%B0%BF%E6%9E%84%E6%88%90%E8%A6%81%E7%B4%A0"><span class="toc-text">1.1.2.1 订单簿构成要素</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-2-2-%E5%85%B3%E9%94%AE%E6%9C%AF%E8%AF%AD%E5%AE%9A%E4%B9%89"><span class="toc-text">1.1.2.2 关键术语定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-2-3-%E8%AE%A2%E5%8D%95%E7%B0%BF%E7%BB%93%E6%9E%84%E7%A4%BA%E4%BE%8B"><span class="toc-text">1.1.2.3 订单簿结构示例</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%B0%B8%E7%BB%AD%E5%90%88%E7%BA%A6%E4%BA%A4%E6%98%93%E6%9C%BA%E5%88%B6"><span class="toc-text">2. 永续合约交易机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-%E5%BC%80%E4%BB%93%E4%B8%8E%E5%B9%B3%E4%BB%93%E6%93%8D%E4%BD%9C"><span class="toc-text">2.1 开仓与平仓操作</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-%E5%BC%80%E4%BB%93%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86"><span class="toc-text">2.1.1 开仓机制原理</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-%E5%B9%B3%E4%BB%93%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86"><span class="toc-text">2.1.2 平仓机制原理</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-%E6%8C%81%E4%BB%93%E6%A8%A1%E5%BC%8F%E5%AF%B9%E6%AF%94%E5%88%86%E6%9E%90"><span class="toc-text">2.2 持仓模式对比分析</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-%E4%B9%B0%E5%8D%96%E6%A8%A1%E5%BC%8F%EF%BC%88%E5%8D%95%E5%90%91%E6%8C%81%E4%BB%93%EF%BC%89"><span class="toc-text">2.2.1 买卖模式（单向持仓）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-%E5%BC%80%E5%B9%B3%E6%A8%A1%E5%BC%8F%EF%BC%88%E5%8F%8C%E5%90%91%E6%8C%81%E4%BB%93%EF%BC%89"><span class="toc-text">2.2.2 开平模式（双向持仓）</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-3-%E6%9C%AC%E8%B4%A8%E5%B7%AE%E5%BC%82%E5%88%86%E6%9E%90"><span class="toc-text">2.2.3 本质差异分析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-3-1-%E5%87%80%E5%A4%B4%E5%AF%B8%E7%9B%B8%E5%90%8C"><span class="toc-text">2.2.3.1 净头寸相同</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-3-2-%E5%85%B3%E9%94%AE%E5%8C%BA%E5%88%AB"><span class="toc-text">2.2.3.2 关键区别</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-4-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF%E5%88%86%E6%9E%90"><span class="toc-text">2.2.4 适用场景分析</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-4-1-%E5%8D%95%E5%90%91%E6%8C%81%E4%BB%93"><span class="toc-text">2.2.4.1 单向持仓</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-4-2-%E5%8F%8C%E5%90%91%E6%8C%81%E4%BB%93"><span class="toc-text">2.2.4.2 双向持仓</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E4%BB%B7%E6%A0%BC%E5%8F%91%E7%8E%B0%E4%B8%8E%E8%B5%84%E9%87%91%E8%B4%B9%E7%8E%87%E6%9C%BA%E5%88%B6"><span class="toc-text">3. 价格发现与资金费率机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-%E8%B5%84%E9%87%91%E8%B4%B9%E7%8E%87%E6%9C%BA%E5%88%B6%E5%8E%9F%E7%90%86"><span class="toc-text">3.1 资金费率机制原理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-1-%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E4%B8%8E%E4%BD%9C%E7%94%A8"><span class="toc-text">3.1.1 基本概念与作用</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-2-%E8%AE%A1%E7%AE%97%E5%8E%9F%E7%90%86%E4%B8%8E%E8%B6%8B%E5%8A%BF%E6%9C%BA%E5%88%B6"><span class="toc-text">3.1.2 计算原理与趋势机制</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-2-1-%E5%9F%BA%E6%9C%AC%E6%80%9D%E6%83%B3"><span class="toc-text">3.1.2.1 基本思想</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-2-2-%E8%B6%8B%E5%8A%BF%E6%9C%BA%E5%88%B6"><span class="toc-text">3.1.2.2 趋势机制</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-3-%E5%85%B7%E4%BD%93%E7%AE%97%E6%B3%95%EF%BC%88OKX%E9%87%87%E7%94%A8%E6%96%B0%E7%89%88%E8%AE%A1%E7%AE%97%E9%80%BB%E8%BE%91%EF%BC%89"><span class="toc-text">3.1.3 具体算法（OKX采用新版计算逻辑）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-3-1-%E5%85%AC%E5%BC%8F%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3"><span class="toc-text">3.1.3.1 公式设计思想</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-3-2-%E5%85%AC%E5%BC%8F%E7%AC%A6%E5%8F%B7%E8%AF%B4%E6%98%8E"><span class="toc-text">3.1.3.2 公式符号说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-1-3-3-%E8%AE%A1%E7%AE%97%E6%AD%A5%E9%AA%A4"><span class="toc-text">3.1.3.3 计算步骤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-%E6%A0%87%E8%AE%B0%E4%BB%B7%E6%A0%BC%E4%B8%8E%E7%8E%B0%E8%B4%A7%E6%8C%87%E6%95%B0%E4%BB%B7%E6%A0%BC%E8%AE%A1%E7%AE%97"><span class="toc-text">3.2 标记价格与现货指数价格计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-%E7%8E%B0%E8%B4%A7%E6%8C%87%E6%95%B0%E4%BB%B7%E6%A0%BC%E8%AE%A1%E7%AE%97"><span class="toc-text">3.2.1 现货指数价格计算</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-1-1-%E5%85%AC%E5%BC%8F%E7%AC%A6%E5%8F%B7%E8%AF%B4%E6%98%8E"><span class="toc-text">3.2.1.1 公式符号说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-1-2-%E5%9F%BA%E7%A1%80%E8%AE%A1%E7%AE%97%E8%A7%84%E5%88%99"><span class="toc-text">3.2.1.2 基础计算规则</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-1-3-%E5%88%86%E7%BA%A7%E5%8A%A0%E6%9D%83%E6%9C%BA%E5%88%B6"><span class="toc-text">3.2.1.3 分级加权机制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-1-4-%E5%BC%82%E5%B8%B8%E4%BB%B7%E6%A0%BC%E5%A4%84%E7%90%86"><span class="toc-text">3.2.1.4 异常价格处理</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-%E6%A0%87%E8%AE%B0%E4%BB%B7%E6%A0%BC%E8%AE%A1%E7%AE%97"><span class="toc-text">3.2.2 标记价格计算</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-1-%E5%9F%BA%E5%B7%AE%E7%A7%BB%E5%8A%A8%E5%B9%B3%E5%9D%87%E5%80%BC%E8%AE%A1%E7%AE%97"><span class="toc-text">3.2.2.1 基差移动平均值计算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-2-%E8%AE%A1%E7%AE%97%E6%96%B9%E6%B3%95%E8%AF%A6%E8%A7%A3"><span class="toc-text">3.2.2.2 计算方法详解</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-3-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E7%9B%B4%E6%8E%A5%E7%94%A8%E6%8C%87%E6%95%B0%E4%BB%B7%E6%A0%BC%EF%BC%8C%E8%BF%98%E8%A6%81%E5%8A%A0%E5%9F%BA%E5%B7%AE%E7%A7%BB%E5%8A%A8%E5%B9%B3%E5%9D%87%E5%80%BC%EF%BC%9F"><span class="toc-text">3.2.2.3 为什么不直接用指数价格，还要加基差移动平均值？</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-4-%E5%AE%9E%E9%99%85%E6%A1%88%E4%BE%8B%E5%AF%B9%E6%AF%94"><span class="toc-text">3.2.2.4 实际案例对比</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-5-%E7%AC%A6%E5%8F%B7%E8%AF%B4%E6%98%8E"><span class="toc-text">3.2.2.5 符号说明</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-6-%E7%AE%97%E6%B3%95%E8%AE%BE%E8%AE%A1%E6%80%9D%E6%83%B3"><span class="toc-text">3.2.2.6 算法设计思想</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#3-2-2-7-%E4%B8%8E%E6%9C%80%E6%96%B0%E4%BB%B7%E6%A0%BC%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="toc-text">3.2.2.7 与最新价格的区别</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-%E4%B8%A4%E8%80%85%E5%85%B3%E7%B3%BB%E6%80%BB%E7%BB%93"><span class="toc-text">3.2.3 两者关系总结</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%AE%9E%E4%BE%8B%E8%AE%A1%E7%AE%97%E4%B8%8E%E4%BF%9D%E8%AF%81%E9%87%91%E5%88%B6%E5%BA%A6"><span class="toc-text">4. 实例计算与保证金制度</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-%E5%90%88%E7%BA%A6%E8%A7%84%E6%A0%BC%E4%B8%8E%E6%94%B6%E7%9B%8A%E8%AE%A1%E7%AE%97"><span class="toc-text">4.1 合约规格与收益计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-1-%E5%90%88%E7%BA%A6%E8%A7%84%E6%A0%BC%E7%A4%BA%E4%BE%8B"><span class="toc-text">4.1.1 合约规格示例</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-1-1-TONUSDT%E6%B0%B8%E7%BB%AD%E5%90%88%E7%BA%A6%E8%A7%84%E6%A0%BC"><span class="toc-text">4.1.1.1 TONUSDT永续合约规格</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-1-2-%E6%B0%B8%E7%BB%AD%E5%90%88%E7%BA%A6%E6%94%B6%E7%9B%8A%E4%B8%8E%E8%B4%B9%E7%94%A8%E8%AE%A1%E7%AE%97"><span class="toc-text">4.1.2 永续合约收益与费用计算</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-2-1-USDT%E6%9C%AC%E4%BD%8D%E6%B0%B8%E7%BB%AD%E5%90%88%E7%BA%A6%E6%94%B6%E7%9B%8A%E8%AE%A1%E7%AE%97%EF%BC%88%E5%AE%98%E6%96%B9%E5%85%AC%E5%BC%8F%EF%BC%89"><span class="toc-text">4.1.2.1 USDT本位永续合约收益计算（官方公式）</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-2-2-%E4%BB%A5TONUSDT%E6%B0%B8%E7%BB%AD%E5%90%88%E7%BA%A6%E4%B8%BA%E4%BE%8B"><span class="toc-text">4.1.2.2 以TONUSDT永续合约为例</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-2-3-%E8%B5%84%E9%87%91%E8%B4%B9%E7%94%A8%E8%AE%A1%E7%AE%97"><span class="toc-text">4.1.2.3 资金费用计算</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-1-2-4-%E5%AE%9E%E9%99%85%E5%87%80%E6%94%B6%E7%9B%8A"><span class="toc-text">4.1.2.4 实际净收益</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-%E6%9D%A0%E6%9D%86%E4%B8%8E%E4%BF%9D%E8%AF%81%E9%87%91%E5%88%B6%E5%BA%A6"><span class="toc-text">4.2 杠杆与保证金制度</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-1-%E6%9D%A0%E6%9D%86%E5%80%8D%E6%95%B0%E8%A7%84%E5%88%99"><span class="toc-text">4.2.1 杠杆倍数规则</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-2-%E4%BF%9D%E8%AF%81%E9%87%91%E6%A8%A1%E5%BC%8F"><span class="toc-text">4.2.2 保证金模式</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#4-2-2-1-%E5%85%A8%E4%BB%93%E4%BF%9D%E8%AF%81%E9%87%91%E6%A8%A1%E5%BC%8F"><span class="toc-text">4.2.2.1 全仓保证金模式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#4-2-2-2-%E9%80%90%E4%BB%93%E4%BF%9D%E8%AF%81%E9%87%91%E6%A8%A1%E5%BC%8F"><span class="toc-text">4.2.2.2 逐仓保证金模式</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-2-3-%E4%BF%9D%E8%AF%81%E9%87%91%E8%AE%A1%E7%AE%97%E5%85%AC%E5%BC%8F"><span class="toc-text">4.2.3 保证金计算公式</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E9%A3%8E%E9%99%A9%E7%AE%A1%E7%90%86%E6%9C%BA%E5%88%B6%E4%B8%8E%E5%AE%89%E5%85%A8%E4%BF%9D%E9%9A%9C"><span class="toc-text">5. 风险管理机制与安全保障</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%BC%BA%E5%88%B6%E5%B9%B3%E4%BB%93%E6%9C%BA%E5%88%B6%E8%AF%A6%E8%A7%A3"><span class="toc-text">5.1 强制平仓机制详解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-1-%E5%BC%BA%E5%88%B6%E5%B9%B3%E4%BB%93%E6%9C%BA%E5%88%B6%E6%A0%B8%E5%BF%83%E8%A6%81%E7%B4%A0"><span class="toc-text">5.1.1 强制平仓机制核心要素</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-1-1-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5%E5%AE%9A%E4%B9%89"><span class="toc-text">5.1.1.1 核心概念定义</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-1-2-%E6%A2%AF%E5%BA%A6%E7%BB%B4%E6%8C%81%E4%BF%9D%E8%AF%81%E9%87%91%E7%8E%87%E5%88%B6%E5%BA%A6"><span class="toc-text">5.1.1.2 梯度维持保证金率制度</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-1-3-%E8%A7%A6%E5%8F%91%E6%9D%A1%E4%BB%B6%E4%B8%8E%E5%88%A4%E6%96%AD%E6%B5%81%E7%A8%8B"><span class="toc-text">5.1.1.3 触发条件与判断流程</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-1-4-%E5%BC%BA%E5%88%B6%E5%B9%B3%E4%BB%93%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6"><span class="toc-text">5.1.1.4 强制平仓执行机制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-1-5-%E8%B4%B9%E7%94%A8%E7%BB%93%E6%9E%84"><span class="toc-text">5.1.1.5 费用结构</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-1-6-%E4%BB%B7%E6%A0%BC%E5%B7%AE%E5%BC%82%E9%A3%8E%E9%99%A9%E7%AE%A1%E7%90%86"><span class="toc-text">5.1.1.6 价格差异风险管理</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-2-%E8%87%AA%E5%8A%A8%E5%87%8F%E4%BB%93%E6%9C%BA%E5%88%B6%EF%BC%88ADL%EF%BC%89"><span class="toc-text">5.1.2 自动减仓机制（ADL）</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-2-1-%E6%9C%BA%E5%88%B6%E5%AE%9A%E4%B9%89%E4%B8%8E%E4%BD%9C%E7%94%A8"><span class="toc-text">5.1.2.1 机制定义与作用</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-2-2-%E6%B8%85%E7%AE%97%E4%B8%8EADL%E6%B5%81%E7%A8%8B%E5%9B%BE%E8%A7%A3"><span class="toc-text">5.1.2.2 清算与ADL流程图解</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-2-3-%E8%A7%A6%E5%8F%91%E6%9D%A1%E4%BB%B6"><span class="toc-text">5.1.2.3 触发条件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-2-4-ADL%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99%E4%B8%8E%E9%A3%8E%E9%99%A9%E6%8C%87%E7%A4%BA"><span class="toc-text">5.1.2.4 ADL排序规则与风险指示</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-2-5-%E6%89%A7%E8%A1%8C%E6%9C%BA%E5%88%B6"><span class="toc-text">5.1.2.5 执行机制</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-2-6-ADL%E7%BB%88%E6%AD%A2%E6%9D%A1%E4%BB%B6"><span class="toc-text">5.1.2.6 ADL终止条件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-2-7-%E9%A2%84%E8%AD%A6%E4%B8%8E%E9%98%B2%E8%8C%83"><span class="toc-text">5.1.2.7 预警与防范</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-3-%E4%BF%9D%E9%99%A9%E5%9F%BA%E9%87%91%E5%88%B6%E5%BA%A6"><span class="toc-text">5.1.3 保险基金制度</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-3-1-%E5%9F%BA%E9%87%91%E6%9E%84%E6%88%90"><span class="toc-text">5.1.3.1 基金构成</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#5-1-3-2-%E7%8B%AC%E7%AB%8B%E8%BF%90%E8%90%A5"><span class="toc-text">5.1.3.2 独立运营</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-1-4-%E6%A0%87%E8%AE%B0%E4%BB%B7%E6%A0%BC%E7%B3%BB%E7%BB%9F"><span class="toc-text">5.1.4 标记价格系统</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E4%BA%A4%E6%98%93%E8%B4%B9%E7%94%A8%E7%BB%93%E6%9E%84%E4%B8%8E%E5%AE%9A%E4%BB%B7%E6%9C%BA%E5%88%B6"><span class="toc-text">6. 交易费用结构与定价机制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-%E8%B4%B9%E7%94%A8%E7%BB%93%E6%9E%84%E4%B8%8E%E7%BA%A7%E5%88%AB%E5%88%B6%E5%BA%A6"><span class="toc-text">6.1 费用结构与级别制度</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-1-%E6%89%8B%E7%BB%AD%E8%B4%B9%E5%88%86%E7%BA%A7%E5%88%B6%E5%BA%A6"><span class="toc-text">6.1.1 手续费分级制度</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-1-2-%E8%B4%B9%E7%8E%87%E7%B1%BB%E5%9E%8B%E5%88%86%E7%B1%BB"><span class="toc-text">6.1.2 费率类型分类</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E6%9D%90%E6%96%99"><span class="toc-text">参考材料</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>Recent Posts</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/finance/fundiing-rate/" title="资金费率套利完整指南">资金费率套利完整指南</a><time datetime="2025-10-05T10:26:20.000Z" title="Created 2025-10-05 18:26:20">2025-10-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/finance/options-arbitrage-strategy-modeling/" title="期权组合套利策略的数学分析和建模"><img src="https://cdn.blog-blockchain.xyz/2025/08/16db5eba53f859fa8c4b45badfb216b8.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="期权组合套利策略的数学分析和建模"></a><div class="content"><a class="title" href="/finance/options-arbitrage-strategy-modeling/" title="期权组合套利策略的数学分析和建模">期权组合套利策略的数学分析和建模</a><time datetime="2025-08-31T07:45:00.000Z" title="Created 2025-08-31 15:45:00">2025-08-31</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/defi/hyperliquid/" title="Hyperliquid 深度调研报告"><img src="https://cdn.blog-blockchain.xyz/2025/08/fb9eea41890628fa5f769e1e85c59609.jpeg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Hyperliquid 深度调研报告"></a><div class="content"><a class="title" href="/defi/hyperliquid/" title="Hyperliquid 深度调研报告">Hyperliquid 深度调研报告</a><time datetime="2025-08-08T00:49:22.000Z" title="Created 2025-08-08 08:49:22">2025-08-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/finance/ltcm-risk-management-case-study/" title="华尔街&quot;梦幻团队&quot;的惨痛教训：LTCM如何在4个月内损失46亿美元"><img src="https://cdn.blog-blockchain.xyz/2025/07/3aeebf60c26b2a9809d7091517c4f856.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="华尔街&quot;梦幻团队&quot;的惨痛教训：LTCM如何在4个月内损失46亿美元"></a><div class="content"><a class="title" href="/finance/ltcm-risk-management-case-study/" title="华尔街&quot;梦幻团队&quot;的惨痛教训：LTCM如何在4个月内损失46亿美元">华尔街"梦幻团队"的惨痛教训：LTCM如何在4个月内损失46亿美元</a><time datetime="2025-07-27T06:31:00.000Z" title="Created 2025-07-27 14:31:00">2025-07-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/finance/ftx-alameda-collapse-case-study/" title="320亿美元消失记：FTX帝国崩塌背后的人性贪婪与制度失效"><img src="https://cdn.blog-blockchain.xyz/2025/07/449fc564e4e9aa38a6eaf425abc6ef44.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="320亿美元消失记：FTX帝国崩塌背后的人性贪婪与制度失效"></a><div class="content"><a class="title" href="/finance/ftx-alameda-collapse-case-study/" title="320亿美元消失记：FTX帝国崩塌背后的人性贪婪与制度失效">320亿美元消失记：FTX帝国崩塌背后的人性贪婪与制度失效</a><time datetime="2025-07-27T06:26:20.000Z" title="Created 2025-07-27 14:26:20">2025-07-27</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">©2020 - 2025 By Michael(Jiahao) Luo</div><div class="framework-info"><span>Framework </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://hexo.io">Hexo 7.3.0</a><span class="footer-separator">|</span><span>Theme </span><a target="_blank" rel="noopener external nofollow noreferrer" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly 5.3.5</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="Reading Mode"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="Toggle Between Light and Dark Mode"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="Toggle Between Single-column and Double-column"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="Settings"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="Table of Contents"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="Scroll to Comments"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="Back to Top"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.36/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><div class="js-pjax"></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.4/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zindex="-1" mobile="false" data-click="false"></script><script async="" data-pjax="" src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js?v=1759658738692"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">Search</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="text-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  Loading Database</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="Search for Posts" type="text"></div></div><hr><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div></div></div><script src="/bundle.js"></script><script>(async () => {
  const showKatex = () => {
    document.querySelectorAll('#article-container .katex').forEach(el => el.classList.add('katex-show'))
  }

  if (!window.katex_js_css) {
    window.katex_js_css = true
    await btf.getCSS('https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/katex.min.css')
    if (false) {
      await btf.getScript('https://cdn.jsdelivr.net/npm/katex@0.16.21/dist/contrib/copy-tex.min.js')
    }
  }

  showKatex()
})();
(() => {
  const runMermaid = ele => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    ele.forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = `%%{init:{ 'theme':'${theme}'}}%%\n`
      const mermaidID = `mermaid-${index}`
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)
      const renderMermaid = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      // mermaid v9 and v10 compatibility
      typeof renderFn === 'string' ? renderMermaid(renderFn) : renderFn.then(({ svg }) => renderMermaid(svg))
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return

    codeMermaidEle.forEach(ele => {
      const preEle = document.createElement('pre')
      preEle.className = 'mermaid-src'
      preEle.hidden = true
      preEle.textContent = ele.textContent
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.appendChild(preEle)
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (true) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@11.4.1/dist/mermaid.min.js').then(runMermaidFn)
  }

  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})();
(() => {
  const isShuoshuo = GLOBAL_CONFIG_SITE.pageType === 'shuoshuo'
  const option = null

  const commentCount = n => {
    const isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
    if (isCommentCount) {
      isCommentCount.textContent= n
    }
  }

  const initGitalk = (el, path) => {
    if (isShuoshuo) {
      window.shuoshuoComment.destroyGitalk = () => {
        if (el.children.length) {
          el.innerHTML = ''
          el.classList.add('no-comment')
        }
      }
    }

    const gitalk = new Gitalk({
      clientID: '467d9506710fff22dc33',
      clientSecret: '2a3e530b895af9c94d4bbe95fe78c69317f4d76e',
      repo: 'blog-gitalk',
      owner: 'learnerLj',
      admin: ['learnerLj'],
      updateCountCallback: commentCount,
      ...option,
      id: isShuoshuo ? path : (option && option.id) || '5bc1a41c4332f46979b130869ce3dbf1'
    })

    gitalk.render('gitalk-container')
  }

  const loadGitalk = async(el, path) => {
    if (typeof Gitalk === 'function') initGitalk(el, path)
    else {
      await btf.getCSS('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.css')
      await btf.getScript('https://cdn.jsdelivr.net/npm/gitalk@1.8.0/dist/gitalk.min.js')
      initGitalk(el, path)
    }
  }

  if (isShuoshuo) {
    'Gitalk' === 'Gitalk'
      ? window.shuoshuoComment = { loadComment: loadGitalk }
      : window.loadOtherComment = loadGitalk
    return
  }

  if ('Gitalk' === 'Gitalk' || !false) {
    if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
    else loadGitalk()
  } else {
    window.loadOtherComment = loadGitalk
  }
})()</script></body></html>